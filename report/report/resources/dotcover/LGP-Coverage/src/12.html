<html>
	<head>
		<script type="text/javascript" src="../js/coverreport.js">

		</script><script type="text/javascript">
			RANGES_12 = [
   [33,9,33,24,'dccv']
, [34,9,34,10,'dccv']
, [36,13,36,14,'dccv']
, [37,17,37,44,'dccv']
, [38,17,38,64,'dccv']
, [39,17,39,35,'dccv']
, [40,17,40,156,'dccv']
, [41,13,41,14,'dccv']
, [46,9,46,10,'dccv']
, [50,9,50,10,'dccv']
, [52,13,52,14,'dccv']
, [53,17,53,83,'dccv']
, [60,9,60,10,'dccv']
, [64,9,64,10,'dccv']
, [66,13,66,14,'dccv']
, [67,17,67,92,'dccv']
, [69,17,72,19,'dccv']
, [74,17,74,72,'dccv']
, [75,17,75,51,'dccv']
, [76,17,76,44,'dccv']
, [78,17,78,49,'dccv']
, [79,17,79,64,'dccv']
, [80,17,80,38,'dccv']
, [81,13,81,14,'dccv']
, [86,9,86,10,'dccv']
, [90,9,90,10,'dccv']
, [92,13,92,14,'dccv']
, [93,17,93,36,'dccv']
, [95,17,95,53,'dccv']
, [96,17,96,68,'dccv']
, [98,17,99,17,'dccv']
, [100,55,101,23,'dccv']
, [102,13,102,14,'dccv']
, [107,9,107,10,'dccv']
, [111,9,111,10,'dccv']
, [113,13,113,14,'dccv']
, [114,17,115,17,'dccv']
, [116,58,117,23,'dccv']
, [120,17,121,17,'dccv']
, [122,73,123,23,'dccv']
, [126,17,127,17,'dccv']
, [128,70,129,23,'dccv']
, [130,13,130,14,'dccv']
, [135,9,135,10,'dccv']
, [139,9,139,10,'dccv']
, [141,13,141,14,'dccv']
, [142,17,142,31,'dccv']
, [144,17,144,57,'dccv']
, [146,17,146,24,'dccv']
, [146,41,146,60,'dccv']
, [146,26,146,37,'dccv']
, [147,17,147,18,'dccv']
, [148,21,148,72,'dccv']
, [149,21,149,87,'dccv']
, [150,21,150,93,'dccv']
, [152,21,152,45,'dccv']
, [157,21,157,22,'dccv']
, [158,25,158,100,'dccv']
, [159,21,159,22,'dccv']
, [161,21,161,29,'dccv']
, [162,21,162,41,'dccv']
, [163,17,163,18,'dccv']
, [146,38,146,40,'dccv']
, [165,17,165,102,'dccv']
, [166,13,166,14,'dccv']
, [171,9,171,10,'dccv']
, [175,9,175,10,'dccv']
, [177,13,177,14,'dccv']
, [178,17,178,47,'dccv']
, [179,17,179,30,'dccv']
, [180,13,180,14,'dccv']
, [185,9,185,10,'dccv']
, [189,9,189,10,'dccv']
, [191,13,191,14,'dccv']
, [192,17,192,46,'dccv']
, [193,17,193,18,'dccv']
, [194,21,194,47,'dccv']
, [195,21,195,46,'dccv']
, [196,21,196,37,'dccv']
, [197,17,197,18,'dccv']
, [198,13,198,14,'dccv']
, [203,9,203,10,'dccv']
, [99,17,99,18,'dccv']
, [100,21,100,55,'dccv']
, [115,17,115,18,'dccv']
, [116,21,116,58,'dccv']
, [121,17,121,18,'dccv']
, [122,21,122,73,'dccv']
, [127,17,127,18,'dccv']
, [128,21,128,70,'dccv']
, [42,13,42,37,'dcuc']
, [43,13,43,14,'dcuc']
, [44,17,44,53,'dcuc']
, [45,13,45,14,'dcuc']
, [55,13,55,37,'dcuc']
, [56,13,56,14,'dcuc']
, [57,17,57,53,'dcuc']
, [58,17,58,29,'dcuc']
, [82,13,82,37,'dcuc']
, [83,13,83,14,'dcuc']
, [84,17,84,53,'dcuc']
, [85,13,85,14,'dcuc']
, [103,13,103,37,'dcuc']
, [104,13,104,14,'dcuc']
, [105,17,105,53,'dcuc']
, [106,13,106,14,'dcuc']
, [131,13,131,37,'dcuc']
, [132,13,132,14,'dcuc']
, [133,17,133,53,'dcuc']
, [134,13,134,14,'dcuc']
, [153,21,153,22,'dcuc']
, [154,25,154,102,'dcuc']
, [155,21,155,22,'dcuc']
, [167,13,167,37,'dcuc']
, [168,13,168,14,'dcuc']
, [169,17,169,53,'dcuc']
, [170,13,170,14,'dcuc']
, [181,13,181,37,'dcuc']
, [182,13,182,14,'dcuc']
, [183,17,183,53,'dcuc']
, [184,13,184,14,'dcuc']
, [199,13,199,37,'dcuc']
, [200,13,200,14,'dcuc']
, [201,17,201,53,'dcuc']
, [202,13,202,14,'dcuc']
];
		</script><link rel="stylesheet" type="text/css" href="../css/coverreport.css" />
	</head><body>
		<code id="src12" class="dotCoverSource"><pre>#region

using System;
using System.ComponentModel;
using System.Text;
using System.Threading;
using System.Timers;
using System.Windows;
using System.Windows.Threading;
using LGP.Components.Factory;
using Timer = System.Timers.Timer;

#endregion

namespace LGP.Controls
{
    /// &lt;summary&gt;
    ///   Interaction logic for Splash.xaml
    /// &lt;/summary&gt;
    public partial class Splash
    {
        private readonly string _loadingText;
        private bool _closingFininshed;
        private Thread _thread;
        private ThreadStart _threadStart;
        private int _tickNum;
        private Timer _tickticktick;


        /// &lt;summary&gt;
        ///   Constructor for the splash screen
        /// &lt;/summary&gt;
        public Splash()
        {
            try
            {
                this.InitializeComponent();
                this._loadingText = this.textBlockLoading.Text;
                this._tickNum = 3;
                this.textBlockCopyright.Text = &quot;David O Neill&quot; + Environment.NewLine + &quot;&#169; Feeditout.com 2012&quot; + Environment.NewLine + &quot;dave@feeditout.com&quot;;
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private static string Repeat( string value , int count )
        {
            try
            {
                return new StringBuilder().Insert( 0 , value , count ).ToString();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
                return null;
            }
        }


        private void WindowLoaded( object sender , RoutedEventArgs e )
        {
            try
            {
                this.image1.Source = Framework.Images.GetImage( &quot;lgp&quot; , &quot;512x512&quot; ).Source;

                this._tickticktick = new Timer
                {
                    Enabled = true
                };

                this._tickticktick.Elapsed += this.TickticktickElapsed;
                this._tickticktick.Interval = 500;
                this._tickticktick.Start();

                this._threadStart = this.Loader;
                this._thread = new Thread( this._threadStart );
                this._thread.Start();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void TickticktickElapsed( object sender , ElapsedEventArgs e )
        {
            try
            {
                this._tickNum += 1;

                var mod = ( this._tickNum % 3 ) + 1;
                var text = this._loadingText + Repeat( &quot;.&quot; , mod );

                this.textBlockLoading.Dispatcher.BeginInvoke( DispatcherPriority.Normal , ( Action ) ( () =&gt;
                {
                    this.textBlockLoading.Text = text;
                } ) );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void UpdateGuiTextBoxes( string dllpath , string dllComponentName , string dllVersion , int progress , int total )
        {
            try
            {
                this.textBlockDllPath.Dispatcher.BeginInvoke( DispatcherPriority.Normal , ( Action ) ( delegate
                {
                    this.textBlockDllPath.Text = dllpath;
                } ) );


                this.textBlockComponentName.Dispatcher.BeginInvoke( DispatcherPriority.Normal , ( Action ) ( delegate
                {
                    this.textBlockComponentName.Text = dllComponentName;
                } ) );


                this.textBlockComponentVersion.Dispatcher.BeginInvoke( DispatcherPriority.Normal , ( Action ) ( delegate
                {
                    this.textBlockComponentVersion.Text = dllVersion;
                } ) );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void Loader()
        {
            try
            {
                var count = 1;

                var asmNum = Framework.Libraries.Length;

                foreach( var dllPath in Framework.Libraries )
                {
                    Framework.LibraryHandler.LoadIComponent( dllPath );
                    var asmName = Framework.LibraryHandler.GetAssemblyName( dllPath );
                    var asmVersion = Framework.LibraryHandler.GetAssemblyVersion( dllPath );

                    if( Framework.HasError )
                    {
                        this.UpdateGuiTextBoxes( &quot;&quot; , &quot;&quot; , &quot;&quot; , count , Framework.Libraries.Length );
                    }
                    else
                    {
                        this.UpdateGuiTextBoxes( dllPath , asmName , asmVersion , count , asmNum );
                    }

                    count++;
                    Thread.Sleep( 200 );
                }

                this.Dispatcher.BeginInvoke( DispatcherPriority.Normal , ( Action ) ( this.Close ) );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void FormFadeOutCompleted( object sender , EventArgs e )
        {
            try
            {
                this._closingFininshed = true;
                this.Close();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void WindowClosing( object sender , CancelEventArgs e )
        {
            try
            {
                if( !this._closingFininshed )
                {
                    this._tickticktick.Stop();
                    this.FormFadeOut.Begin();
                    e.Cancel = true;
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }
    }
}</pre></code><script type="text/javascript">
			applyranges('src12', RANGES_12)
		</script>
	</body>
</html>