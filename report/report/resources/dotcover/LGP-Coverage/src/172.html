<html>
	<head>
		<script type="text/javascript" src="../js/coverreport.js">

		</script><script type="text/javascript">
			RANGES_172 = [
   [21,9,21,10,'dccv']
, [22,13,22,51,'dccv']
, [23,9,23,10,'dccv']
, [25,9,25,58,'dccv']
, [26,9,26,10,'dccv']
, [27,13,27,61,'dccv']
, [28,13,28,39,'dccv']
, [29,13,29,43,'dccv']
, [30,9,30,10,'dccv']
, [86,9,86,10,'dccv']
, [88,13,88,14,'dccv']
, [89,22,89,32,'dccv']
, [89,33,89,58,'dccv']
, [93,13,93,14,'dccv']
, [98,9,98,10,'dccv']
, [106,9,106,10,'dccv']
, [108,13,108,14,'dccv']
, [109,22,109,32,'dccv']
, [109,33,109,58,'dccv']
, [113,13,113,14,'dccv']
, [118,9,118,10,'dccv']
, [140,9,140,10,'dccv']
, [141,13,141,35,'dccv']
, [142,9,142,10,'dccv']
, [149,9,149,10,'dccv']
, [150,13,150,37,'dccv']
, [151,9,151,10,'dccv']
, [158,9,158,10,'dccv']
, [160,13,160,14,'dccv']
, [161,17,161,120,'dccv']
, [163,17,163,55,'dccv']
, [164,17,164,18,'dccv']
, [165,21,165,63,'dccv']
, [166,17,166,18,'dccv']
, [168,17,168,41,'dccv']
, [169,17,169,31,'dccv']
, [170,13,170,14,'dccv']
, [175,9,175,10,'dccv']
, [185,9,185,10,'dccv']
, [187,13,187,14,'dccv']
, [188,17,188,92,'dccv']
, [189,17,189,31,'dccv']
, [190,17,190,32,'dccv']
, [197,9,197,10,'dccv']
, [238,9,238,10,'dccv']
, [239,13,239,64,'dccv']
, [240,9,240,10,'dccv']
, [283,9,283,10,'dccv']
, [284,13,284,36,'dccv']
, [285,9,285,10,'dccv']
, [285,9,285,10,'dccv']
, [285,9,285,10,'dccv']
, [40,9,40,10,'dcuc']
, [41,13,41,49,'dcuc']
, [50,9,50,10,'dcuc']
, [52,13,52,14,'dcuc']
, [53,17,53,55,'dcuc']
, [54,17,54,18,'dcuc']
, [55,21,55,48,'dcuc']
, [56,17,56,18,'dcuc']
, [57,13,57,14,'dcuc']
, [58,13,58,37,'dcuc']
, [59,13,59,14,'dcuc']
, [60,17,60,53,'dcuc']
, [61,13,61,14,'dcuc']
, [62,9,62,10,'dcuc']
, [70,9,70,10,'dcuc']
, [72,13,72,14,'dcuc']
, [73,17,73,47,'dcuc']
, [74,13,74,14,'dcuc']
, [75,13,75,37,'dcuc']
, [76,13,76,14,'dcuc']
, [77,17,77,53,'dcuc']
, [78,13,78,14,'dcuc']
, [79,9,79,10,'dcuc']
, [90,17,90,18,'dcuc']
, [91,21,91,64,'dcuc']
, [92,17,92,18,'dcuc']
, [89,60,89,63,'dcuc']
, [94,13,94,37,'dcuc']
, [95,13,95,14,'dcuc']
, [96,17,96,53,'dcuc']
, [97,13,97,14,'dcuc']
, [110,17,110,18,'dcuc']
, [111,21,111,58,'dcuc']
, [112,17,112,18,'dcuc']
, [109,60,109,63,'dcuc']
, [114,13,114,37,'dcuc']
, [115,13,115,14,'dcuc']
, [116,17,116,53,'dcuc']
, [117,13,117,14,'dcuc']
, [127,13,127,14,'dcuc']
, [128,17,128,29,'dcuc']
, [129,13,129,14,'dcuc']
, [131,13,131,14,'dcuc']
, [132,13,132,14,'dcuc']
, [171,13,171,37,'dcuc']
, [172,13,172,14,'dcuc']
, [173,17,173,53,'dcuc']
, [174,13,174,14,'dcuc']
, [192,13,192,37,'dcuc']
, [193,13,193,14,'dcuc']
, [194,17,194,53,'dcuc']
, [195,17,195,29,'dcuc']
, [205,9,205,10,'dcuc']
, [207,13,207,14,'dcuc']
, [208,17,208,70,'dcuc']
, [209,17,209,31,'dcuc']
, [210,13,210,14,'dcuc']
, [211,13,211,37,'dcuc']
, [212,13,212,14,'dcuc']
, [213,17,213,53,'dcuc']
, [214,13,214,14,'dcuc']
, [215,9,215,10,'dcuc']
, [221,9,221,10,'dcuc']
, [223,13,223,14,'dcuc']
, [224,17,224,64,'dcuc']
, [225,17,225,31,'dcuc']
, [226,13,226,14,'dcuc']
, [227,13,227,37,'dcuc']
, [228,13,228,14,'dcuc']
, [229,17,229,53,'dcuc']
, [230,13,230,14,'dcuc']
, [231,9,231,10,'dcuc']
, [248,9,248,10,'dcuc']
, [249,13,249,70,'dcuc']
, [250,9,250,10,'dcuc']
, [258,9,258,10,'dcuc']
, [259,13,259,69,'dcuc']
, [260,9,260,10,'dcuc']
, [267,9,267,10,'dcuc']
, [268,13,268,22,'dcuc']
, [269,9,269,10,'dcuc']
, [276,9,276,10,'dcuc']
, [277,13,277,23,'dcuc']
, [278,9,278,10,'dcuc']
];
		</script><link rel="stylesheet" type="text/css" href="../css/coverreport.css" />
	</head><body>
		<code id="src172" class="dotCoverSource"><pre>#region

using System;
using System.Collections.Generic;
using LGP.Components.Database.Gateways;
using LGP.Components.Factory;
using LGP.Components.Factory.Interfaces.Database;

#endregion

namespace LGP.Components.Database.Entities
{
    internal class Module : IModule
    {
        private static readonly IGrammerGateway GrammerGateway;
        private readonly int _moduleid;
        private string _moduleName;
        private List&lt; IModuleObserver &gt; _observers;

        static Module()
        {
            GrammerGateway = new GrammerGateway();
        }

        public Module( int moduleid , string modulename )
        {
            this._observers = new List&lt; IModuleObserver &gt;();
            this._moduleid = moduleid;
            this._moduleName = modulename;
        }

        #region Implementation of IModuleObserver

        /// &lt;summary&gt;
        ///   Update this observer with a refernece to the module
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;module&quot;&gt;IModule&lt;/param&gt;
        /// &lt;param name = &quot;source&quot;&gt;IModuleObserver&lt;/param&gt;
        public void Update( IModule module , IModuleObserver source )
        {
            throw new NotImplementedException();
        }


        /// &lt;summary&gt;
        ///   Attach objewcts that observer this module
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IModuleObserver&lt;/param&gt;
        public void Attach( IModuleObserver obj )
        {
            try
            {
                if( !this._observers.Contains( obj ) )
                {
                    this._observers.Add( obj );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Detach objewcts that observer this module
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IModuleObserver&lt;/param&gt;
        public void Detach( IModuleObserver obj )
        {
            try
            {
                this._observers.Remove( obj );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Notify observers of this module
        /// &lt;/summary&gt;
        public void Notify()
        {
            try
            {
                for( var h = 0; h &lt; this._observers.Count; h++ )
                {
                    this._observers[ h ].Update( this , this );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Dispose this object and all the observers
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IModuleObserver&lt;/param&gt;
        public void Dispose( IModuleObserver obj )
        {
            try
            {
                for( var h = 0; h &lt; this._observers.Count; h++ )
                {
                    this._observers[ h ].Dispose( this );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   The file contents when used by the module editor
        /// &lt;/summary&gt;
        public string FileContents
        {
            get
            {
                return null;
            }
            set
            {
            }
        }

        /// &lt;summary&gt;
        ///   Returns the module id
        /// &lt;/summary&gt;
        /// &lt;returns&gt;int&lt;/returns&gt;
        public int GetModuleId()
        {
            return this._moduleid;
        }

        /// &lt;summary&gt;
        ///   Gets the name of the module
        /// &lt;/summary&gt;
        /// &lt;returns&gt;string&lt;/returns&gt;
        public string GetModuleName()
        {
            return this._moduleName;
        }

        /// &lt;summary&gt;
        ///   Sets the module name
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;name&quot;&gt;&lt;/param&gt;
        public void SetModuleName( string name )
        {
            try
            {
                var sql = String.Format( &quot;update modules set name = &#39;{0}&#39; where id = &#39;{1}&#39; &quot; , name , this._moduleid );

                if( Framework.Database.IsConnected() )
                {
                    Framework.Database.ExecuteNonQuery( sql );
                }

                this._moduleName = name;
                this.Notify();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Adds a grammer to this module
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;key&quot;&gt;string&lt;/param&gt;
        /// &lt;param name = &quot;value&quot;&gt;string&lt;/param&gt;
        /// &lt;returns&gt;IGrammer&lt;/returns&gt;
        public IGrammer AddGrammer( string key , string value )
        {
            try
            {
                var grammer = GrammerGateway.CreateGrammer( this._moduleid , key , value );
                this.Notify();
                return grammer;
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
                return null;
            }
        }


        /// &lt;summary&gt;
        ///   Deletes a grammer given a key
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;key&quot;&gt;&lt;/param&gt;
        public void DeleteGrammer( string key )
        {
            try
            {
                GrammerGateway.DeleteGrammer( this._moduleid , key );
                this.Notify();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Dletes all the grammers associated with this module
        /// &lt;/summary&gt;
        public void DeleteAllGrammer()
        {
            try
            {
                GrammerGateway.DeleteGrammer( this._moduleid );
                this.Notify();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Gets all the grammers for this module
        /// &lt;/summary&gt;
        /// &lt;returns&gt;IGrammer&lt;/returns&gt;
        public List&lt; IGrammer &gt; GetAllGrammers()
        {
            return GrammerGateway.GetGrammer( this._moduleid );
        }

        /// &lt;summary&gt;
        ///   Gets a grammer given a key
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;key&quot;&gt;grammer lvale&lt;/param&gt;
        /// &lt;returns&gt;KeyValuePair&lt;/returns&gt;
        public IGrammer GetGrammer( string key )
        {
            return GrammerGateway.GetGrammer( this._moduleid , key );
        }

        /// &lt;summary&gt;
        ///   Gets a grammer given an id
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;id&quot;&gt;grammer id&lt;/param&gt;
        /// &lt;returns&gt;IGrammer&lt;/returns&gt;
        public IGrammer GetGrammer( int id )
        {
            return GrammerGateway.GetGrammer( this._moduleid , id );
        }

        /// &lt;summary&gt;
        ///   Get the has of the module
        /// &lt;/summary&gt;
        /// &lt;returns&gt;int&lt;/returns&gt;
        public int GetHash()
        {
            return 0;
        }

        /// &lt;summary&gt;
        ///   Gets the module location
        /// &lt;/summary&gt;
        /// &lt;returns&gt;string&lt;/returns&gt;
        public string GetModuleLocation()
        {
            return &quot;&quot;;
        }

        #endregion

        ~Module()
        {
            this._observers = null;
        }
    }
}</pre></code><script type="text/javascript">
			applyranges('src172', RANGES_172)
		</script>
	</body>
</html>