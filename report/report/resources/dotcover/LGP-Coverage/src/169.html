<html>
	<head>
		<script type="text/javascript" src="../js/coverreport.js">

		</script><script type="text/javascript">
			RANGES_169 = [
   [23,9,23,121,'dccv']
, [24,9,24,10,'dccv']
, [25,13,25,61,'dccv']
, [26,13,26,34,'dccv']
, [27,13,27,31,'dccv']
, [28,13,28,37,'dccv']
, [29,13,29,35,'dccv']
, [30,13,30,46,'dccv']
, [31,13,31,61,'dccv']
, [32,13,32,37,'dccv']
, [33,9,33,10,'dccv']
, [52,9,52,10,'dccv']
, [54,13,54,14,'dccv']
, [55,17,55,55,'dccv']
, [56,17,56,18,'dccv']
, [57,21,57,48,'dccv']
, [58,17,58,18,'dccv']
, [59,13,59,14,'dccv']
, [64,9,64,10,'dccv']
, [71,9,71,10,'dccv']
, [73,13,73,14,'dccv']
, [74,17,74,47,'dccv']
, [75,13,75,14,'dccv']
, [80,9,80,10,'dccv']
, [86,9,86,10,'dccv']
, [88,13,88,14,'dccv']
, [89,22,89,32,'dccv']
, [90,17,90,18,'dccv']
, [91,21,91,64,'dccv']
, [92,17,92,18,'dccv']
, [89,60,89,63,'dccv']
, [89,33,89,58,'dccv']
, [93,13,93,14,'dccv']
, [98,9,98,10,'dccv']
, [137,9,137,10,'dccv']
, [138,13,138,31,'dccv']
, [139,9,139,10,'dccv']
, [270,9,270,10,'dccv']
, [271,13,271,30,'dccv']
, [272,9,272,10,'dccv']
, [279,9,279,10,'dccv']
, [281,13,281,14,'dccv']
, [282,17,282,153,'dccv']
, [284,17,284,55,'dccv']
, [285,17,285,18,'dccv']
, [286,21,286,63,'dccv']
, [287,17,287,18,'dccv']
, [289,17,289,33,'dccv']
, [290,17,290,31,'dccv']
, [291,13,291,14,'dccv']
, [296,9,296,10,'dccv']
, [338,9,338,10,'dccv']
, [339,13,339,36,'dccv']
, [340,9,340,10,'dccv']
, [340,9,340,10,'dccv']
, [340,9,340,10,'dccv']
, [43,9,43,10,'dcuc']
, [44,13,44,49,'dcuc']
, [60,13,60,37,'dcuc']
, [61,13,61,14,'dcuc']
, [62,17,62,53,'dcuc']
, [63,13,63,14,'dcuc']
, [76,13,76,37,'dcuc']
, [77,13,77,14,'dcuc']
, [78,17,78,53,'dcuc']
, [79,13,79,14,'dcuc']
, [94,13,94,37,'dcuc']
, [95,13,95,14,'dcuc']
, [96,17,96,53,'dcuc']
, [97,13,97,14,'dcuc']
, [105,9,105,10,'dcuc']
, [107,13,107,14,'dcuc']
, [108,22,108,32,'dcuc']
, [109,17,109,18,'dcuc']
, [110,21,110,58,'dcuc']
, [111,17,111,18,'dcuc']
, [108,60,108,63,'dcuc']
, [108,33,108,58,'dcuc']
, [112,13,112,14,'dcuc']
, [113,13,113,37,'dcuc']
, [114,13,114,14,'dcuc']
, [115,17,115,53,'dcuc']
, [116,13,116,14,'dcuc']
, [117,9,117,10,'dcuc']
, [128,9,128,10,'dcuc']
, [129,13,129,35,'dcuc']
, [130,9,130,10,'dcuc']
, [146,9,146,10,'dcuc']
, [148,13,148,14,'dcuc']
, [149,17,149,122,'dcuc']
, [151,17,151,55,'dcuc']
, [152,17,152,18,'dcuc']
, [153,21,153,63,'dcuc']
, [154,17,154,18,'dcuc']
, [156,17,156,33,'dcuc']
, [157,17,157,31,'dcuc']
, [158,13,158,14,'dcuc']
, [159,13,159,37,'dcuc']
, [160,13,160,14,'dcuc']
, [161,17,161,53,'dcuc']
, [162,13,162,14,'dcuc']
, [163,9,163,10,'dcuc']
, [170,9,170,10,'dcuc']
, [171,13,171,34,'dcuc']
, [172,9,172,10,'dcuc']
, [179,9,179,10,'dcuc']
, [181,13,181,14,'dcuc']
, [182,17,182,129,'dcuc']
, [184,17,184,55,'dcuc']
, [185,17,185,18,'dcuc']
, [186,21,186,63,'dcuc']
, [187,17,187,18,'dcuc']
, [189,17,189,41,'dcuc']
, [190,17,190,31,'dcuc']
, [191,13,191,14,'dcuc']
, [192,13,192,37,'dcuc']
, [193,13,193,14,'dcuc']
, [194,17,194,53,'dcuc']
, [195,13,195,14,'dcuc']
, [196,9,196,10,'dcuc']
, [203,9,203,10,'dcuc']
, [204,13,204,33,'dcuc']
, [205,9,205,10,'dcuc']
, [212,9,212,10,'dcuc']
, [214,13,214,14,'dcuc']
, [215,17,215,127,'dcuc']
, [217,17,217,55,'dcuc']
, [218,17,218,18,'dcuc']
, [219,21,219,63,'dcuc']
, [220,17,220,18,'dcuc']
, [222,17,222,39,'dcuc']
, [223,17,223,31,'dcuc']
, [224,13,224,14,'dcuc']
, [225,13,225,37,'dcuc']
, [226,13,226,14,'dcuc']
, [227,17,227,53,'dcuc']
, [228,13,228,14,'dcuc']
, [229,9,229,10,'dcuc']
, [236,9,236,10,'dcuc']
, [237,13,237,34,'dcuc']
, [238,9,238,10,'dcuc']
, [245,9,245,10,'dcuc']
, [247,13,247,14,'dcuc']
, [248,17,248,45,'dcuc']
, [249,17,249,123,'dcuc']
, [251,17,251,55,'dcuc']
, [252,17,252,18,'dcuc']
, [253,21,253,63,'dcuc']
, [254,17,254,18,'dcuc']
, [256,17,256,41,'dcuc']
, [257,17,257,31,'dcuc']
, [258,13,258,14,'dcuc']
, [259,13,259,37,'dcuc']
, [260,13,260,14,'dcuc']
, [261,17,261,53,'dcuc']
, [262,13,262,14,'dcuc']
, [263,9,263,10,'dcuc']
, [292,13,292,37,'dcuc']
, [293,13,293,14,'dcuc']
, [294,17,294,53,'dcuc']
, [295,13,295,14,'dcuc']
, [303,9,303,10,'dcuc']
, [304,13,304,34,'dcuc']
, [305,9,305,10,'dcuc']
, [312,9,312,10,'dcuc']
, [314,13,314,14,'dcuc']
, [315,17,315,129,'dcuc']
, [317,17,317,55,'dcuc']
, [318,17,318,18,'dcuc']
, [319,21,319,63,'dcuc']
, [320,17,320,18,'dcuc']
, [322,17,322,41,'dcuc']
, [323,17,323,31,'dcuc']
, [324,13,324,14,'dcuc']
, [325,13,325,37,'dcuc']
, [326,13,326,14,'dcuc']
, [327,17,327,53,'dcuc']
, [328,13,328,14,'dcuc']
, [329,9,329,10,'dcuc']
];
		</script><link rel="stylesheet" type="text/css" href="../css/coverreport.css" />
	</head><body>
		<code id="src169" class="dotCoverSource"><pre>#region

using System;
using System.Collections.Generic;
using LGP.Components.Factory;
using LGP.Components.Factory.Interfaces.Database;

#endregion

namespace LGP.Components.Database.Entities
{
    internal class Policy : IPolicy
    {
        private readonly int _policyid;
        private string _created;
        private string _dsl;
        private string _edited;
        private bool _enabled;
        private List&lt; IPolicyObserver &gt; _observers;
        private int _ouid;
        private string _version;

        public Policy( int pid , string created , string edited , int enabled , string dsl , int ouid , string version )
        {
            this._observers = new List&lt; IPolicyObserver &gt;();
            this._policyid = pid;
            this._ouid = ouid;
            this._created = created;
            this._edited = edited;
            this._enabled = ( enabled == 1 );
            this._dsl = Framework.Utils.Base64Decode( dsl );
            this._version = version;
        }

        #region Implementation of IPolicyObserver

        /// &lt;summary&gt;
        ///   Update this observer with a refernece to the ou
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;policy&quot;&gt;IPolicy&lt;/param&gt;
        /// &lt;param name = &quot;source&quot;&gt;source observer&lt;/param&gt;
        public void Update( IPolicy policy , IPolicyObserver source )
        {
            throw new NotImplementedException();
        }

        /// &lt;summary&gt;
        ///   Attach objects that observer this IPolicy
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IPolicyObserver&lt;/param&gt;
        public void Attach( IPolicyObserver obj )
        {
            try
            {
                if( !this._observers.Contains( obj ) )
                {
                    this._observers.Add( obj );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Detach objects that observer this IPolicy
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IPolicyObserver&lt;/param&gt;
        public void Detach( IPolicyObserver obj )
        {
            try
            {
                this._observers.Remove( obj );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Notify observers of this IPolicy
        /// &lt;/summary&gt;
        public void Notify()
        {
            try
            {
                for( var h = 0; h &lt; this._observers.Count; h++ )
                {
                    this._observers[ h ].Update( this , this );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Dispose this object and all the observers
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IPolicyObserver&lt;/param&gt;
        public void Dispose( IPolicyObserver obj )
        {
            try
            {
                for( var h = 0; h &lt; this._observers.Count; h++ )
                {
                    this._observers[ h ].Dispose( this );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        #endregion

        #region Implementation of IPolicy

        /// &lt;summary&gt;
        ///   Gets the id of this policy
        /// &lt;/summary&gt;
        /// &lt;returns&gt;int&lt;/returns&gt;
        public int GetId()
        {
            return this._policyid;
        }

        /// &lt;summary&gt;
        ///   Gets the ou id
        /// &lt;/summary&gt;
        /// &lt;returns&gt;int&lt;/returns&gt;
        public int GetOuId()
        {
            return this._ouid;
        }

        /// &lt;summary&gt;
        ///   Sets the ou id
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;id&quot;&gt;int&lt;/param&gt;
        public void SetOuId( int id )
        {
            try
            {
                var sql = String.Format( &quot;update policy set p_ou_id = &#39;{0}&#39; where p_id = &#39;{1}&#39; &quot; , id , this._policyid );

                if( Framework.Database.IsConnected() )
                {
                    Framework.Database.ExecuteNonQuery( sql );
                }

                this._ouid = id;
                this.Notify();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Gets the created date
        /// &lt;/summary&gt;
        /// &lt;returns&gt;string&lt;/returns&gt;
        public string GetCreated()
        {
            return this._created;
        }

        /// &lt;summary&gt;
        ///   Sets the created date
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;created&quot;&gt;string&lt;/param&gt;
        public void SetCreated( string created )
        {
            try
            {
                var sql = String.Format( &quot;update policy set p_created = &#39;{0}&#39; where p_id = &#39;{1}&#39; &quot; , created , this._policyid );

                if( Framework.Database.IsConnected() )
                {
                    Framework.Database.ExecuteNonQuery( sql );
                }

                this._created = created;
                this.Notify();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Gets the edited date
        /// &lt;/summary&gt;
        /// &lt;returns&gt;string&lt;/returns&gt;
        public string GetEdited()
        {
            return this._edited;
        }

        /// &lt;summary&gt;
        ///   Sets the edited date
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;edited&quot;&gt;string&lt;/param&gt;
        public void SetEdited( string edited )
        {
            try
            {
                var sql = String.Format( &quot;update policy set p_edited = &#39;{0}&#39; where p_id = &#39;{1}&#39; &quot; , edited , this._policyid );

                if( Framework.Database.IsConnected() )
                {
                    Framework.Database.ExecuteNonQuery( sql );
                }

                this._edited = edited;
                this.Notify();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Gets the enabled status
        /// &lt;/summary&gt;
        /// &lt;returns&gt;bool&lt;/returns&gt;
        public bool IsEnabled()
        {
            return this._enabled;
        }

        /// &lt;summary&gt;
        ///   Sets the enabled status
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;enabled&quot;&gt;&lt;/param&gt;
        public void SetEnabled( bool enabled )
        {
            try
            {
                var b = ( enabled ) ? 1 : 0;
                var sql = String.Format( &quot;update policy set p_enabled = &#39;{0}&#39; where p_id = &#39;{1}&#39; &quot; , b , this._policyid );

                if( Framework.Database.IsConnected() )
                {
                    Framework.Database.ExecuteNonQuery( sql );
                }

                this._enabled = enabled;
                this.Notify();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Get the DSL or rules
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public string GetDsl()
        {
            return this._dsl;
        }

        /// &lt;summary&gt;
        ///   Set the DSL rules
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;dsl&quot;&gt;&lt;/param&gt;
        public void SetDsl( string dsl )
        {
            try
            {
                var sql = String.Format( &quot;update policy set p_dsl = &#39;{0}&#39; where p_id = &#39;{1}&#39; &quot; , Framework.Utils.Base64Encode( dsl ) , this._policyid );

                if( Framework.Database.IsConnected() )
                {
                    Framework.Database.ExecuteNonQuery( sql );
                }

                this._dsl = dsl;
                this.Notify();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Gets the version
        /// &lt;/summary&gt;
        /// &lt;returns&gt;string&lt;/returns&gt;
        public string GetVersion()
        {
            return this._version;
        }

        /// &lt;summary&gt;
        ///   Sets the version
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;version&quot;&gt;string&lt;/param&gt;
        public void SetVersion( string version )
        {
            try
            {
                var sql = String.Format( &quot;update policy set p_version = &#39;{0}&#39; where p_id = &#39;{1}&#39; &quot; , version , this._policyid );

                if( Framework.Database.IsConnected() )
                {
                    Framework.Database.ExecuteNonQuery( sql );
                }

                this._version = version;
                this.Notify();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        #endregion

        /// &lt;summary&gt;
        ///   Allows an &lt;see cref = &quot;T:System.Object&quot; /&gt; to attempt to free resources and perform other cleanup operations before the &lt;see
        ///    cref = &quot;T:System.Object&quot; /&gt; is reclaimed by garbage collection.
        /// &lt;/summary&gt;
        ~Policy()
        {
            this._observers = null;
        }
    }
}</pre></code><script type="text/javascript">
			applyranges('src169', RANGES_169)
		</script>
	</body>
</html>