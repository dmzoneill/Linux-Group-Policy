<html>
	<head>
		<script type="text/javascript" src="../js/coverreport.js">

		</script><script type="text/javascript">
			RANGES_165 = [
   [22,9,22,72,'dccv']
, [23,9,23,10,'dccv']
, [24,13,24,57,'dccv']
, [25,13,25,29,'dccv']
, [26,13,26,33,'dccv']
, [27,13,27,41,'dccv']
, [28,13,28,41,'dccv']
, [29,9,29,10,'dccv']
, [63,9,63,10,'dccv']
, [64,13,64,31,'dccv']
, [65,9,65,10,'dccv']
, [73,9,73,10,'dccv']
, [75,13,75,14,'dccv']
, [76,17,76,117,'dccv']
, [78,17,78,55,'dccv']
, [79,17,79,18,'dccv']
, [80,21,80,63,'dccv']
, [81,17,81,18,'dccv']
, [83,17,83,36,'dccv']
, [84,17,84,31,'dccv']
, [85,13,85,14,'dccv']
, [90,9,90,10,'dccv']
, [98,9,98,10,'dccv']
, [99,13,99,33,'dccv']
, [100,9,100,10,'dccv']
, [108,9,108,10,'dccv']
, [110,13,110,14,'dccv']
, [111,17,111,122,'dccv']
, [113,17,113,55,'dccv']
, [114,17,114,18,'dccv']
, [115,21,115,63,'dccv']
, [116,17,116,18,'dccv']
, [118,17,118,40,'dccv']
, [119,17,119,31,'dccv']
, [120,13,120,14,'dccv']
, [125,9,125,10,'dccv']
, [133,9,133,10,'dccv']
, [134,13,134,37,'dccv']
, [135,9,135,10,'dccv']
, [179,9,179,10,'dccv']
, [181,13,181,14,'dccv']
, [182,17,182,45,'dccv']
, [184,17,184,31,'dccv']
, [187,25,187,44,'dccv']
, [188,25,188,31,'dccv']
, [191,25,191,44,'dccv']
, [192,25,192,31,'dccv']
, [195,25,195,44,'dccv']
, [196,25,196,31,'dccv']
, [199,25,199,45,'dccv']
, [200,25,200,31,'dccv']
, [203,25,203,44,'dccv']
, [204,25,204,31,'dccv']
, [207,17,207,78,'dccv']
, [214,9,214,10,'dccv']
, [232,9,232,10,'dccv']
, [234,13,234,14,'dccv']
, [235,17,235,55,'dccv']
, [236,17,236,18,'dccv']
, [237,21,237,48,'dccv']
, [238,17,238,18,'dccv']
, [239,13,239,14,'dccv']
, [244,9,244,10,'dccv']
, [252,9,252,10,'dccv']
, [254,13,254,14,'dccv']
, [255,17,255,47,'dccv']
, [256,13,256,14,'dccv']
, [261,9,261,10,'dccv']
, [268,9,268,10,'dccv']
, [270,13,270,14,'dccv']
, [271,22,271,32,'dccv']
, [272,17,272,18,'dccv']
, [273,21,273,64,'dccv']
, [274,17,274,18,'dccv']
, [271,60,271,63,'dccv']
, [271,33,271,58,'dccv']
, [275,13,275,14,'dccv']
, [280,9,280,10,'dccv']
, [288,9,288,10,'dccv']
, [290,13,290,14,'dccv']
, [291,22,291,32,'dccv']
, [292,17,292,18,'dccv']
, [293,21,293,58,'dccv']
, [294,17,294,18,'dccv']
, [291,60,291,63,'dccv']
, [291,33,291,58,'dccv']
, [295,13,295,14,'dccv']
, [300,9,300,10,'dccv']
, [309,9,309,10,'dccv']
, [310,13,310,36,'dccv']
, [311,9,311,10,'dccv']
, [311,9,311,10,'dccv']
, [311,9,311,10,'dccv']
, [38,9,38,10,'dcuc']
, [40,13,40,14,'dcuc']
, [41,17,41,115,'dcuc']
, [43,17,43,55,'dcuc']
, [44,17,44,18,'dcuc']
, [45,21,45,63,'dcuc']
, [46,17,46,18,'dcuc']
, [48,17,48,34,'dcuc']
, [49,17,49,31,'dcuc']
, [50,13,50,14,'dcuc']
, [51,13,51,37,'dcuc']
, [52,13,52,14,'dcuc']
, [53,17,53,53,'dcuc']
, [54,13,54,14,'dcuc']
, [55,9,55,10,'dcuc']
, [86,13,86,37,'dcuc']
, [87,13,87,14,'dcuc']
, [88,17,88,53,'dcuc']
, [89,13,89,14,'dcuc']
, [121,13,121,37,'dcuc']
, [122,13,122,14,'dcuc']
, [123,17,123,53,'dcuc']
, [124,13,124,14,'dcuc']
, [143,9,143,10,'dcuc']
, [145,13,145,14,'dcuc']
, [146,17,146,124,'dcuc']
, [148,17,148,55,'dcuc']
, [149,17,149,18,'dcuc']
, [150,21,150,63,'dcuc']
, [151,17,151,18,'dcuc']
, [153,17,153,43,'dcuc']
, [154,17,154,31,'dcuc']
, [155,13,155,14,'dcuc']
, [156,13,156,37,'dcuc']
, [157,13,157,14,'dcuc']
, [158,17,158,53,'dcuc']
, [159,13,159,14,'dcuc']
, [160,9,160,10,'dcuc']
, [168,9,168,10,'dcuc']
, [169,13,169,40,'dcuc']
, [170,9,170,10,'dcuc']
, [209,13,209,37,'dcuc']
, [210,13,210,14,'dcuc']
, [211,17,211,53,'dcuc']
, [212,17,212,29,'dcuc']
, [223,9,223,10,'dcuc']
, [224,13,224,49,'dcuc']
, [240,13,240,37,'dcuc']
, [241,13,241,14,'dcuc']
, [242,17,242,53,'dcuc']
, [243,13,243,14,'dcuc']
, [257,13,257,37,'dcuc']
, [258,13,258,14,'dcuc']
, [259,17,259,53,'dcuc']
, [260,13,260,14,'dcuc']
, [276,13,276,37,'dcuc']
, [277,13,277,14,'dcuc']
, [278,17,278,53,'dcuc']
, [279,13,279,14,'dcuc']
, [296,13,296,37,'dcuc']
, [297,13,297,14,'dcuc']
, [298,17,298,53,'dcuc']
, [299,13,299,14,'dcuc']
];
		</script><link rel="stylesheet" type="text/css" href="../css/coverreport.css" />
	</head><body>
		<code id="src165" class="dotCoverSource"><pre>#region

using System;
using System.Collections.Generic;
using System.Windows.Controls;
using LGP.Components.Factory;
using LGP.Components.Factory.Interfaces.Database;

#endregion

namespace LGP.Components.Database.Entities
{
    internal class Ou : IOu
    {
        private List&lt; IOuObserver &gt; _observers;
        private int _ouId;
        private string _ouName;
        private int _ouParentId;
        private string _oupolicyGroup;


        public Ou( int id , string name , int parentid , string group )
        {
            this._observers = new List&lt; IOuObserver &gt;();
            this._ouId = id;
            this._ouName = name;
            this._ouParentId = parentid;
            this._oupolicyGroup = group;
        }

        #region IOu Members

        /// &lt;summary&gt;
        ///   Sets the ou Id
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;val&quot;&gt;int&lt;/param&gt;
        public void SetOuId( int val )
        {
            try
            {
                var sql = String.Format( &quot;update ous set ou_id = &#39;{0}&#39; where ou_id = &#39;{1}&#39; &quot; , val , this._ouId );

                if( Framework.Database.IsConnected() )
                {
                    Framework.Database.ExecuteNonQuery( sql );
                }

                this._ouId = val;
                this.Notify();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Gets the ou Id
        /// &lt;/summary&gt;
        /// &lt;returns&gt;int&lt;/returns&gt;
        public int GetOuId()
        {
            return this._ouId;
        }


        /// &lt;summary&gt;
        ///   Sets the ou name
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;val&quot;&gt;string&lt;/param&gt;
        public void SetName( string val )
        {
            try
            {
                var sql = String.Format( &quot;update ous set ou_name = &#39;{0}&#39; where ou_id = &#39;{1}&#39; &quot; , val , this._ouId );

                if( Framework.Database.IsConnected() )
                {
                    Framework.Database.ExecuteNonQuery( sql );
                }

                this._ouName = val;
                this.Notify();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Gets the ou name
        /// &lt;/summary&gt;
        /// &lt;returns&gt;string&lt;/returns&gt;
        public string GetName()
        {
            return this._ouName;
        }


        /// &lt;summary&gt;
        ///   Sets the parent ou Id
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;val&quot;&gt;int&lt;/param&gt;
        public void SetParentOuId( int val )
        {
            try
            {
                var sql = String.Format( &quot;update ous set ou_parent_id = &#39;{0}&#39; where ou_id = &#39;{1}&#39; &quot; , val , this._ouId );

                if( Framework.Database.IsConnected() )
                {
                    Framework.Database.ExecuteNonQuery( sql );
                }

                this._ouParentId = val;
                this.Notify();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Gets the parent ou Id
        /// &lt;/summary&gt;
        /// &lt;returns&gt;int&lt;/returns&gt;
        public int GetParentOuId()
        {
            return this._ouParentId;
        }


        /// &lt;summary&gt;
        ///   Sets the ou policy group
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;val&quot;&gt;&lt;/param&gt;
        public void SetPolicyGroup( string val )
        {
            try
            {
                var sql = String.Format( &quot;update ous set ou_policygroup = &#39;{0}&#39; where ou_id = &#39;{1}&#39; &quot; , val , this._ouId );

                if( Framework.Database.IsConnected() )
                {
                    Framework.Database.ExecuteNonQuery( sql );
                }

                this._oupolicyGroup = val;
                this.Notify();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Gets the ou policy group
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public string GetPolicyGroup()
        {
            return this._oupolicyGroup;
        }


        /// &lt;summary&gt;
        ///   Gets the ou image
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;size&quot;&gt;int&lt;/param&gt;
        /// &lt;returns&gt;image&lt;/returns&gt;
        public Image GetOuImage( int size )
        {
            try
            {
                var sizeFolder = &quot;distros/&quot;;

                switch( size )
                {
                    case 32 :
                        sizeFolder += &quot;32&quot;;
                        break;

                    case 48 :
                        sizeFolder += &quot;48&quot;;
                        break;

                    case 64 :
                        sizeFolder += &quot;64&quot;;
                        break;

                    case 128 :
                        sizeFolder += &quot;128&quot;;
                        break;

                    default :
                        sizeFolder += &quot;32&quot;;
                        break;
                }

                return Framework.Images.GetImage( &quot;workgroup&quot; , sizeFolder );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
                return null;
            }
        }


        /// &lt;summary&gt;
        ///   Update this observer with a refernece to the ou
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;ou&quot;&gt;Iou&lt;/param&gt;
        /// &lt;param name = &quot;source&quot;&gt;source observer&lt;/param&gt;
        public void Update( IOu ou , IOuObserver source )
        {
            throw new NotImplementedException();
        }

        /// &lt;summary&gt;
        ///   Attach objewcts that observer this IOu
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IOuObserver&lt;/param&gt;
        public void Attach( IOuObserver obj )
        {
            try
            {
                if( !this._observers.Contains( obj ) )
                {
                    this._observers.Add( obj );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Detach objewcts that observer this IOu
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IOuObserver&lt;/param&gt;
        public void Detach( IOuObserver obj )
        {
            try
            {
                this._observers.Remove( obj );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Notify observers of this IOu
        /// &lt;/summary&gt;
        public void Notify()
        {
            try
            {
                for( var h = 0; h &lt; this._observers.Count; h++ )
                {
                    this._observers[ h ].Update( this , this );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Dispose this object and all the observers
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IOuObserver&lt;/param&gt;
        public void Dispose( IOuObserver obj )
        {
            try
            {
                for( var h = 0; h &lt; this._observers.Count; h++ )
                {
                    this._observers[ h ].Dispose( this );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        #endregion

        /// &lt;summary&gt;
        ///   Allows an &lt;see cref = &quot;T:System.Object&quot; /&gt; to attempt to free resources and perform other cleanup operations before the &lt;see
        ///    cref = &quot;T:System.Object&quot; /&gt; is reclaimed by garbage collection.
        /// &lt;/summary&gt;
        ~Ou()
        {
            this._observers = null;
        }
    }
}</pre></code><script type="text/javascript">
			applyranges('src165', RANGES_165)
		</script>
	</body>
</html>