<html>
	<head>
		<script type="text/javascript" src="../js/coverreport.js">

		</script><script type="text/javascript">
			RANGES_6 = [
   [41,9,41,27,'dccv']
, [42,9,42,10,'dccv']
, [44,13,44,14,'dccv']
, [45,17,45,44,'dccv']
, [47,17,47,52,'dccv']
, [49,17,49,43,'dccv']
, [51,17,51,52,'dccv']
, [53,17,53,103,'dccv']
, [55,17,55,118,'dccv']
, [56,17,56,118,'dccv']
, [57,17,57,130,'dccv']
, [58,13,58,14,'dccv']
, [63,9,63,10,'dccv']
, [66,9,66,10,'dccv']
, [67,13,70,15,'dccv']
, [71,13,71,38,'dccv']
, [72,13,72,37,'dccv']
, [73,9,73,10,'dccv']
, [81,9,81,10,'dccv']
, [83,13,83,14,'dccv']
, [84,17,84,46,'dccv']
, [89,17,89,48,'dccv']
, [90,17,90,18,'dccv']
, [91,21,91,34,'dccv']
, [92,17,92,18,'dccv']
, [93,22,93,60,'dccv']
, [94,17,94,18,'dccv']
, [95,21,98,23,'dccv']
, [99,21,99,46,'dccv']
, [100,21,100,45,'dccv']
, [101,17,101,18,'dccv']
, [102,22,102,58,'dccv']
, [103,17,103,18,'dccv']
, [104,21,104,137,'dccv']
, [105,17,105,18,'dccv']
, [106,13,106,14,'dccv']
, [111,9,111,10,'dccv']
, [119,9,119,10,'dccv']
, [121,13,121,14,'dccv']
, [122,17,122,74,'dccv']
, [123,17,123,18,'dccv']
, [124,21,124,76,'dccv']
, [125,21,125,73,'dccv']
, [126,21,126,80,'dccv']
, [127,21,127,80,'dccv']
, [128,17,128,18,'dccv']
, [129,13,129,14,'dccv']
, [134,9,134,10,'dccv']
, [143,9,143,10,'dccv']
, [145,13,145,14,'dccv']
, [146,17,146,62,'dccv']
, [148,17,148,61,'dccv']
, [150,17,150,106,'dccv']
, [151,17,151,93,'dccv']
, [153,17,156,19,'dccv']
, [157,17,157,61,'dccv']
, [158,13,158,14,'dccv']
, [163,9,163,10,'dccv']
, [195,9,195,10,'dccv']
, [197,13,197,14,'dccv']
, [198,17,198,40,'dccv']
, [199,13,199,14,'dccv']
, [204,9,204,10,'dccv']
, [231,9,231,10,'dccv']
, [233,13,233,14,'dccv']
, [234,17,234,47,'dccv']
, [235,17,235,33,'dccv']
, [236,13,236,14,'dccv']
, [241,13,241,41,'dccv']
, [242,9,242,10,'dccv']
, [59,13,59,37,'dcuc']
, [60,13,60,14,'dcuc']
, [61,17,61,53,'dcuc']
, [62,13,62,14,'dcuc']
, [85,17,85,18,'dcuc']
, [86,21,86,28,'dcuc']
, [107,13,107,37,'dcuc']
, [108,13,108,14,'dcuc']
, [109,17,109,53,'dcuc']
, [110,13,110,14,'dcuc']
, [130,13,130,37,'dcuc']
, [131,13,131,14,'dcuc']
, [132,17,132,53,'dcuc']
, [133,13,133,14,'dcuc']
, [159,13,159,37,'dcuc']
, [160,13,160,14,'dcuc']
, [161,17,161,53,'dcuc']
, [162,13,162,14,'dcuc']
, [166,9,166,10,'dcuc']
, [167,13,167,62,'dcuc']
, [168,13,168,14,'dcuc']
, [170,13,170,14,'dcuc']
, [172,13,172,14,'dcuc']
, [173,17,173,62,'dcuc']
, [175,17,175,43,'dcuc']
, [176,17,176,18,'dcuc']
, [177,21,177,63,'dcuc']
, [178,21,178,59,'dcuc']
, [179,17,179,18,'dcuc']
, [181,17,181,18,'dcuc']
, [182,21,182,63,'dcuc']
, [183,21,183,62,'dcuc']
, [184,17,184,18,'dcuc']
, [185,13,185,14,'dcuc']
, [186,9,186,10,'dcuc']
, [200,13,200,37,'dcuc']
, [201,13,201,14,'dcuc']
, [202,17,202,53,'dcuc']
, [203,13,203,14,'dcuc']
, [213,9,213,10,'dcuc']
, [215,13,215,14,'dcuc']
, [216,17,216,31,'dcuc']
, [217,13,217,14,'dcuc']
, [218,13,218,37,'dcuc']
, [219,13,219,14,'dcuc']
, [220,17,220,53,'dcuc']
, [221,13,221,14,'dcuc']
, [222,9,222,10,'dcuc']
, [237,13,237,37,'dcuc']
, [238,13,238,14,'dcuc']
, [239,17,239,53,'dcuc']
, [240,13,240,14,'dcuc']
, [251,9,251,10,'dcuc']
, [253,13,253,14,'dcuc']
, [254,17,254,30,'dcuc']
, [255,13,255,14,'dcuc']
, [256,13,256,37,'dcuc']
, [257,13,257,14,'dcuc']
, [258,17,258,53,'dcuc']
, [259,13,259,14,'dcuc']
, [260,9,260,10,'dcuc']
, [269,9,269,10,'dcuc']
, [271,13,271,14,'dcuc']
, [272,17,272,31,'dcuc']
, [273,13,273,14,'dcuc']
, [274,13,274,37,'dcuc']
, [275,13,275,14,'dcuc']
, [276,17,276,53,'dcuc']
, [277,13,277,14,'dcuc']
, [278,9,278,10,'dcuc']
, [285,9,285,10,'dcuc']
, [287,13,287,14,'dcuc']
, [288,17,288,149,'dcuc']
, [289,17,289,18,'dcuc']
, [290,21,290,48,'dcuc']
, [291,21,291,46,'dcuc']
, [292,21,292,50,'dcuc']
, [293,21,293,52,'dcuc']
, [294,17,294,18,'dcuc']
, [296,17,296,18,'dcuc']
, [297,21,297,50,'dcuc']
, [298,21,298,52,'dcuc']
, [299,21,299,46,'dcuc']
, [300,21,300,48,'dcuc']
, [302,21,302,73,'dcuc']
, [303,21,303,75,'dcuc']
, [304,21,304,35,'dcuc']
, [305,21,305,34,'dcuc']
, [306,17,306,18,'dcuc']
, [307,13,307,14,'dcuc']
, [308,13,308,37,'dcuc']
, [309,13,309,14,'dcuc']
, [310,17,310,53,'dcuc']
, [311,13,311,14,'dcuc']
, [312,9,312,10,'dcuc']
, [321,9,321,10,'dcuc']
, [323,13,323,14,'dcuc']
, [324,17,324,57,'dcuc']
, [325,13,325,14,'dcuc']
, [326,13,326,37,'dcuc']
, [327,13,327,14,'dcuc']
, [328,17,328,53,'dcuc']
, [329,13,329,14,'dcuc']
, [330,9,330,10,'dcuc']
];
		</script><link rel="stylesheet" type="text/css" href="../css/coverreport.css" />
	</head><body>
		<code id="src6" class="dotCoverSource"><pre>#region

using System;
using System.ComponentModel;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Forms;
using System.Windows.Input;
using LGP.Components.Factory;
using LGP.Components.Factory.Publishers.Events;
using LGP.Controls;
using Microsoft.Practices.Prism.Events;
using ContextMenu = System.Windows.Forms.ContextMenu;
using Cursors = System.Windows.Input.Cursors;
using MenuItem = System.Windows.Forms.MenuItem;
using MouseEventArgs = System.Windows.Forms.MouseEventArgs;
using UserControl = System.Windows.Controls.UserControl;

#endregion

namespace LGP
{
    /// &lt;summary&gt;
    ///   Interaction logic for LGPWindow.xaml
    /// &lt;/summary&gt;
    public partial class LGPWindow
    {
        private NotifyIcon _notify;
        private double _prevHeight;
        private double _prevLeft;
        private double _prevTop;
        private double _prevWidth;
        private bool _shownInTaskbar;


        /// &lt;summary&gt;
        ///   Constructor
        ///   Shows the splash screen loader
        ///   Subscribes to events
        /// &lt;/summary&gt;
        public LGPWindow()
        {
            try
            {
                this.InitializeComponent();

                Framework.ApplicationWindow = this;

                new Splash().ShowDialog();

                Framework.Panels.SubscribeEvents();

                this.Icon = Framework.Images.ConvertBitmapToImage( Properties.Images.lgpico1 ).Source;

                Framework.EventBus.Subscribe&lt; MenuEvent &gt;( this.HandleMenuItemClick , ThreadOption.UIThread , true );
                Framework.EventBus.Subscribe&lt; PanelEvent &gt;( this.HandlePanelRequest , ThreadOption.UIThread , true );
                Framework.EventBus.Subscribe&lt; PreferencesEvent &gt;( this.HandlePreferencesRequest , ThreadOption.UIThread , true );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void HandlePreferencesRequest( PreferencesEvent pevent )
        {
            var preferences = new Settings( pevent )
            {
                Owner = this
            };
            preferences.ShowDialog();
            this.InvalidateVisual();
        }


        /// &lt;summary&gt;
        ///   Generic message handler for menu item clicked events
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;details&quot;&gt;&lt;/param&gt;
        private void HandleMenuItemClick( MenuEvent details )
        {
            try
            {
                if( details.Command == null )
                {
                    return;
                }

                if( details.Command == &quot;exit&quot; )
                {
                    this.Close();
                }
                else if( details.Command == &quot;preferences&quot; )
                {
                    var preferences = new Settings
                    {
                        Owner = this
                    };
                    preferences.ShowDialog();
                    this.InvalidateVisual();
                }
                else if( details.Command == &quot;statusBar&quot; )
                {
                    this.statusBarRow.Height = ( int ) this.statusBarRow.Height.Value == 0 ? new GridLength( 25 ) : new GridLength( 0 );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Generic message handler for menu item clicked events
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;details&quot;&gt;&lt;/param&gt;
        private void HandlePanelRequest( PanelEvent details )
        {
            try
            {
                if( ( ( UserControl ) Framework.Panels ).Parent == null )
                {
                    Grid.SetColumn( ( UserControl ) Framework.Panels , 0 );
                    Grid.SetRow( ( UserControl ) Framework.Panels , 2 );
                    Grid.SetColumnSpan( ( UserControl ) Framework.Panels , 3 );
                    this.main.Children.Add( ( UserControl ) Framework.Panels );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Window loaded internal event
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;sender&quot;&gt;The object that raised the window loaded event&lt;/param&gt;
        /// &lt;param name = &quot;e&quot;&gt;Event arguments associated with the event&lt;/param&gt;
        private void WindowLoaded( object sender , RoutedEventArgs e )
        {
            try
            {
                this._shownInTaskbar = !this._shownInTaskbar;

                Framework.Menu.InitializeMenu( this.menu1 );

                this.dragBar.PreviewMouseLeftButtonDown += this.ChromeLessWindowSpaceMouseLeftButtonDown;
                this.dragBar.PreviewMouseDoubleClick += this.DragBarPreviewMouseDoubleClick;

                this._notify = new NotifyIcon
                {
                    Text = Properties.Resources.LinuxGroupPolicyStudio , Icon = Framework.Images.GetIcon( &quot;lgpico&quot; ) , Visible = true
                };
                this._notify.MouseClick += this.NotifyClick;
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void NotifyClick( object sender , MouseEventArgs e )
        {
            if( e != null &amp;&amp; e.Button == MouseButtons.Right )
            {
                // to do right click menu
            }
            else
            {
                this._shownInTaskbar = !this._shownInTaskbar;

                if( this._shownInTaskbar )
                {
                    this.ShowInTaskbar = this._shownInTaskbar;
                    this.WindowState = WindowState.Normal;
                }
                else
                {
                    this.ShowInTaskbar = this._shownInTaskbar;
                    this.WindowState = WindowState.Minimized;
                }
            }
        }


        /// &lt;summary&gt;
        ///   Generic window closing event
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;sender&quot;&gt;The object that raised the window closing event&lt;/param&gt;
        /// &lt;param name = &quot;e&quot;&gt;Event arguments associated with the event&lt;/param&gt;
        private void LGPMainWindowClosing( object sender , CancelEventArgs e )
        {
            try
            {
                this._notify.Dispose();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Title bar double click event handler
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;sender&quot;&gt;The object that raised the double click event&lt;/param&gt;
        /// &lt;param name = &quot;e&quot;&gt;Event arguments associated with the event&lt;/param&gt;
        private void DragBarPreviewMouseDoubleClick( object sender , MouseButtonEventArgs e )
        {
            try
            {
                this.Resize();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Title bar click event handler
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;sender&quot;&gt;The object that raised the click event&lt;/param&gt;
        /// &lt;param name = &quot;e&quot;&gt;Event arguments associated with the event&lt;/param&gt;
        private void ChromeLessWindowSpaceMouseLeftButtonDown( object sender , MouseButtonEventArgs e )
        {
            try
            {
                this.Cursor = Cursors.SizeAll;
                this.DragMove();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
            this.Cursor = Cursors.Arrow;
        }


        /// &lt;summary&gt;
        ///   The window close button event handler
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;sender&quot;&gt;The object that raised the click event&lt;/param&gt;
        /// &lt;param name = &quot;e&quot;&gt;Event arguments associated with the event&lt;/param&gt;
        private void ButtonWindowCloseClick( object sender , RoutedEventArgs e )
        {
            try
            {
                this.Close();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   The window maximize button event handler
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;sender&quot;&gt;The object that raised the click event&lt;/param&gt;
        /// &lt;param name = &quot;e&quot;&gt;Event arguments associated with the event&lt;/param&gt;
        private void ButtonWindowMaximizeClick( object sender , RoutedEventArgs e )
        {
            try
            {
                this.Resize();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Wpf window mode breaks maximize so we need to do it ourselves.
        /// &lt;/summary&gt;
        private void Resize()
        {
            try
            {
                if( ( int ) this.Width == Screen.PrimaryScreen.WorkingArea.Width &amp;&amp; ( int ) this.Height == Screen.PrimaryScreen.WorkingArea.Height )
                {
                    this.Left = this._prevLeft;
                    this.Top = this._prevTop;
                    this.Width = this._prevWidth;
                    this.Height = this._prevHeight;
                }
                else
                {
                    this._prevWidth = this.Width;
                    this._prevHeight = this.Height;
                    this._prevTop = this.Top;
                    this._prevLeft = this.Left;

                    this.Width = Screen.PrimaryScreen.WorkingArea.Width;
                    this.Height = Screen.PrimaryScreen.WorkingArea.Height;
                    this.Left = 0;
                    this.Top = 0;
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   The window minimize button event handler
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;sender&quot;&gt;The object that raised the click event&lt;/param&gt;
        /// &lt;param name = &quot;e&quot;&gt;Event arguments associated with the event&lt;/param&gt;
        private void ButtonWindowMinimizeClick( object sender , RoutedEventArgs e )
        {
            try
            {
                this.NotifyClick( this._notify , null );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }
    }
}</pre></code><script type="text/javascript">
			applyranges('src6', RANGES_6)
		</script>
	</body>
</html>