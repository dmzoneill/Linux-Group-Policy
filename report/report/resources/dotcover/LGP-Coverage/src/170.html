<html>
	<head>
		<script type="text/javascript" src="../js/coverreport.js">

		</script><script type="text/javascript">
			RANGES_170 = [
   [20,9,20,79,'dccv']
, [21,9,21,10,'dccv']
, [22,13,22,62,'dccv']
, [23,13,23,29,'dccv']
, [24,13,24,39,'dccv']
, [25,13,25,33,'dccv']
, [26,13,26,33,'dccv']
, [27,9,27,10,'dccv']
, [36,9,36,10,'dccv']
, [37,13,37,32,'dccv']
, [38,9,38,10,'dccv']
, [46,9,46,10,'dccv']
, [47,13,47,35,'dccv']
, [48,9,48,10,'dccv']
, [56,9,56,10,'dccv']
, [57,13,57,30,'dccv']
, [58,9,58,10,'dccv']
, [66,9,66,10,'dccv']
, [67,13,67,32,'dccv']
, [68,9,68,10,'dccv']
, [75,9,75,10,'dccv']
, [77,13,77,14,'dccv']
, [78,17,78,127,'dccv']
, [80,17,80,55,'dccv']
, [81,17,81,18,'dccv']
, [82,21,82,63,'dccv']
, [83,17,83,18,'dccv']
, [85,17,85,38,'dccv']
, [86,17,86,31,'dccv']
, [87,13,87,14,'dccv']
, [92,9,92,10,'dccv']
, [100,9,100,10,'dccv']
, [102,13,102,14,'dccv']
, [103,17,103,133,'dccv']
, [105,17,105,55,'dccv']
, [106,17,106,18,'dccv']
, [107,21,107,63,'dccv']
, [108,17,108,18,'dccv']
, [110,17,110,33,'dccv']
, [111,17,111,31,'dccv']
, [112,13,112,14,'dccv']
, [117,9,117,10,'dccv']
, [125,9,125,10,'dccv']
, [127,13,127,14,'dccv']
, [128,17,128,133,'dccv']
, [130,17,130,55,'dccv']
, [131,17,131,18,'dccv']
, [132,21,132,63,'dccv']
, [133,17,133,18,'dccv']
, [135,17,135,35,'dccv']
, [136,17,136,31,'dccv']
, [137,13,137,14,'dccv']
, [142,9,142,10,'dccv']
, [203,9,203,10,'dccv']
, [205,13,205,14,'dccv']
, [206,22,206,32,'dccv']
, [206,33,206,58,'dccv']
, [210,13,210,14,'dccv']
, [215,9,215,10,'dccv']
, [239,9,239,10,'dccv']
, [240,13,240,36,'dccv']
, [241,9,241,10,'dccv']
, [241,9,241,10,'dccv']
, [241,9,241,10,'dccv']
, [245,9,245,10,'dccv']
, [246,13,246,34,'dccv']
, [247,9,247,10,'dccv']
, [88,13,88,37,'dcuc']
, [89,13,89,14,'dcuc']
, [90,17,90,53,'dcuc']
, [91,13,91,14,'dcuc']
, [113,13,113,37,'dcuc']
, [114,13,114,14,'dcuc']
, [115,17,115,53,'dcuc']
, [116,13,116,14,'dcuc']
, [138,13,138,37,'dcuc']
, [139,13,139,14,'dcuc']
, [140,17,140,53,'dcuc']
, [141,13,141,14,'dcuc']
, [154,9,154,10,'dcuc']
, [156,13,156,14,'dcuc']
, [157,13,157,14,'dcuc']
, [158,13,158,37,'dcuc']
, [159,13,159,14,'dcuc']
, [160,17,160,53,'dcuc']
, [161,13,161,14,'dcuc']
, [162,9,162,10,'dcuc']
, [169,9,169,10,'dcuc']
, [171,13,171,14,'dcuc']
, [172,17,172,55,'dcuc']
, [173,17,173,18,'dcuc']
, [174,21,174,48,'dcuc']
, [175,17,175,18,'dcuc']
, [176,13,176,14,'dcuc']
, [177,13,177,37,'dcuc']
, [178,13,178,14,'dcuc']
, [179,17,179,53,'dcuc']
, [180,13,180,14,'dcuc']
, [181,9,181,10,'dcuc']
, [188,9,188,10,'dcuc']
, [190,13,190,14,'dcuc']
, [191,17,191,47,'dcuc']
, [192,13,192,14,'dcuc']
, [193,13,193,37,'dcuc']
, [194,13,194,14,'dcuc']
, [195,17,195,53,'dcuc']
, [196,13,196,14,'dcuc']
, [197,9,197,10,'dcuc']
, [207,17,207,18,'dcuc']
, [208,21,208,64,'dcuc']
, [209,17,209,18,'dcuc']
, [206,60,206,63,'dcuc']
, [211,13,211,37,'dcuc']
, [212,13,212,14,'dcuc']
, [213,17,213,53,'dcuc']
, [214,13,214,14,'dcuc']
, [222,9,222,10,'dcuc']
, [224,13,224,14,'dcuc']
, [225,22,225,32,'dcuc']
, [226,17,226,18,'dcuc']
, [227,21,227,58,'dcuc']
, [228,17,228,18,'dcuc']
, [225,60,225,63,'dcuc']
, [225,33,225,58,'dcuc']
, [229,13,229,14,'dcuc']
, [230,13,230,37,'dcuc']
, [231,13,231,14,'dcuc']
, [232,17,232,53,'dcuc']
, [233,13,233,14,'dcuc']
, [234,9,234,10,'dcuc']
];
		</script><link rel="stylesheet" type="text/css" href="../css/coverreport.css" />
	</head><body>
		<code id="src170" class="dotCoverSource"><pre>#region

using System;
using System.Collections.Generic;
using LGP.Components.Factory;
using LGP.Components.Factory.Interfaces.Database;

#endregion

namespace LGP.Components.Database.Entities
{
    internal class Grammer : IGrammer
    {
        private readonly int _rowid;
        private string _key;
        private int _moduleid;
        private List&lt; IGrammerObserver &gt; _observers;
        private string _value;

        public Grammer( int rowid , int moduleid , string key , string value )
        {
            this._observers = new List&lt; IGrammerObserver &gt;();
            this._key = key;
            this._moduleid = moduleid;
            this._rowid = rowid;
            this._value = value;
        }

        #region IGrammer Members

        /// &lt;summary&gt;
        ///   Gets the grammer rowid
        /// &lt;/summary&gt;
        /// &lt;returns&gt;int&lt;/returns&gt;
        public int GetId()
        {
            return this._rowid;
        }


        /// &lt;summary&gt;
        ///   Gets the grammer moduleid
        /// &lt;/summary&gt;
        /// &lt;returns&gt;int&lt;/returns&gt;
        public int GetModuleId()
        {
            return this._moduleid;
        }


        /// &lt;summary&gt;
        ///   Gets the grammer key
        /// &lt;/summary&gt;
        /// &lt;returns&gt;string&lt;/returns&gt;
        public string GetKey()
        {
            return this._key;
        }


        /// &lt;summary&gt;
        ///   Gets the grammer value
        /// &lt;/summary&gt;
        /// &lt;returns&gt;string&lt;/returns&gt;
        public string GetValue()
        {
            return this._value;
        }

        /// &lt;summary&gt;
        ///   Sets the grammer moduleid
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;val&quot;&gt;int&lt;/param&gt;
        public void SetModuleId( int val )
        {
            try
            {
                var sql = String.Format( &quot;update moduleGrammerWords set m_id = &#39;{0}&#39; where id = &#39;{1}&#39; &quot; , val , this._rowid );

                if( Framework.Database.IsConnected() )
                {
                    Framework.Database.ExecuteNonQuery( sql );
                }

                this._moduleid = val;
                this.Notify();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Sets the grammer key
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;val&quot;&gt;string&lt;/param&gt;
        public void SetKey( string val )
        {
            try
            {
                var sql = String.Format( &quot;update moduleGrammerWords set grammerkey = &#39;{0}&#39; where id = &#39;{1}&#39; &quot; , val , this._rowid );

                if( Framework.Database.IsConnected() )
                {
                    Framework.Database.ExecuteNonQuery( sql );
                }

                this._key = val;
                this.Notify();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Sets the grammer value
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;val&quot;&gt;string&lt;/param&gt;
        public void SetValue( string val )
        {
            try
            {
                var sql = String.Format( &quot;update moduleGrammerWords set grammerval = &#39;{0}&#39; where id = &#39;{1}&#39; &quot; , val , this._rowid );

                if( Framework.Database.IsConnected() )
                {
                    Framework.Database.ExecuteNonQuery( sql );
                }

                this._value = val;
                this.Notify();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        #endregion

        #region Implementation of IGrammerObserver

        /// &lt;summary&gt;
        ///   Update this observer with a refernece to the grammer
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;grammer&quot;&gt;IGrammer&lt;/param&gt;
        /// &lt;param name = &quot;source&quot;&gt;IGrammerObserver&lt;/param&gt;
        public void Update( IGrammer grammer , IGrammerObserver source )
        {
            try
            {
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Attach objewcts that observer this grammer
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IGrammerObserver&lt;/param&gt;
        public void Attach( IGrammerObserver obj )
        {
            try
            {
                if( !this._observers.Contains( obj ) )
                {
                    this._observers.Add( obj );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Detach objewcts that observer this grammer
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IGrammerObserver&lt;/param&gt;
        public void Detach( IGrammerObserver obj )
        {
            try
            {
                this._observers.Remove( obj );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Notify observers of this grammer
        /// &lt;/summary&gt;
        public void Notify()
        {
            try
            {
                for( var h = 0; h &lt; this._observers.Count; h++ )
                {
                    this._observers[ h ].Update( this , this );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Dispose this object and all the observers
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IGrammerObserver&lt;/param&gt;
        public void Dispose( IGrammerObserver obj )
        {
            try
            {
                for( var h = 0; h &lt; this._observers.Count; h++ )
                {
                    this._observers[ h ].Dispose( this );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        #endregion

        ~Grammer()
        {
            this._observers = null;
        }


        public override string ToString()
        {
            return this.GetKey();
        }
    }
}</pre></code><script type="text/javascript">
			applyranges('src170', RANGES_170)
		</script>
	</body>
</html>