<html>
	<head>
		<script type="text/javascript" src="../js/coverreport.js">

		</script><script type="text/javascript">
			RANGES_229 = [
   [25,9,25,127,'dccv']
, [32,9,32,24,'dccv']
, [33,9,33,10,'dccv']
, [35,13,35,14,'dccv']
, [36,17,36,44,'dccv']
, [37,17,37,45,'dccv']
, [38,17,38,39,'dccv']
, [40,17,40,135,'dccv']
, [41,13,41,14,'dccv']
, [46,9,46,10,'dccv']
, [54,13,54,14,'dccv']
, [55,17,55,46,'dccv']
, [56,13,56,14,'dccv']
, [65,9,65,10,'dccv']
, [66,13,66,111,'dccv']
, [67,13,67,110,'dccv']
, [68,9,68,10,'dccv']
, [97,9,97,10,'dccv']
, [98,13,98,34,'dccv']
, [103,13,103,14,'dccv']
, [104,17,104,70,'dccv']
, [106,17,106,35,'dccv']
, [108,17,108,24,'dccv']
, [108,54,108,80,'dccv']
, [108,26,108,50,'dccv']
, [109,17,109,18,'dccv']
, [110,21,110,54,'dccv']
, [116,17,116,18,'dccv']
, [108,51,108,53,'dccv']
, [118,17,118,63,'dccv']
, [119,17,119,18,'dccv']
, [120,21,123,23,'dccv']
, [125,21,125,76,'dccv']
, [126,21,126,71,'dccv']
, [127,21,127,62,'dccv']
, [128,21,128,48,'dccv']
, [129,17,129,18,'dccv']
, [131,17,131,33,'dccv']
, [132,17,132,41,'dccv']
, [133,13,133,14,'dccv']
, [138,9,138,10,'dccv']
, [172,9,172,10,'dccv']
, [174,13,174,14,'dccv']
, [175,17,175,70,'dccv']
, [177,17,177,41,'dccv']
, [178,17,178,50,'dccv']
, [180,17,180,24,'dccv']
, [180,51,180,84,'dccv']
, [180,26,180,47,'dccv']
, [181,17,181,18,'dccv']
, [182,21,182,81,'dccv']
, [183,21,183,22,'dccv']
, [184,25,184,44,'dccv']
, [185,25,185,43,'dccv']
, [186,21,186,22,'dccv']
, [187,17,187,18,'dccv']
, [180,48,180,50,'dccv']
, [189,17,189,43,'dccv']
, [190,17,190,18,'dccv']
, [191,21,191,49,'dccv']
, [193,21,193,59,'dccv']
, [199,21,202,23,'dccv']
, [203,21,206,23,'dccv']
, [207,21,207,82,'dccv']
, [209,21,209,81,'dccv']
, [210,21,210,65,'dccv']
, [211,21,211,51,'dccv']
, [212,17,212,18,'dccv']
, [214,17,214,18,'dccv']
, [215,21,215,56,'dccv']
, [216,21,216,42,'dccv']
, [218,21,218,62,'dccv']
, [219,21,219,41,'dccv']
, [220,17,220,18,'dccv']
, [222,17,222,33,'dccv']
, [223,17,223,41,'dccv']
, [224,13,224,14,'dccv']
, [229,9,229,10,'dccv']
, [237,9,237,10,'dccv']
, [239,13,239,14,'dccv']
, [240,17,240,24,'dccv']
, [240,51,240,84,'dccv']
, [240,26,240,47,'dccv']
, [241,17,241,18,'dccv']
, [242,21,242,66,'dccv']
, [243,21,243,51,'dccv']
, [244,21,244,22,'dccv']
, [245,25,245,39,'dccv']
, [246,25,246,38,'dccv']
, [247,25,247,31,'dccv']
, [249,17,249,18,'dccv']
, [240,48,240,50,'dccv']
, [250,13,250,14,'dccv']
, [255,9,255,10,'dccv']
, [262,9,262,10,'dccv']
, [264,13,264,14,'dccv']
, [265,17,265,24,'dccv']
, [265,51,265,84,'dccv']
, [265,26,265,47,'dccv']
, [266,17,266,18,'dccv']
, [267,21,267,66,'dccv']
, [268,21,268,63,'dccv']
, [269,21,269,56,'dccv']
, [270,21,270,37,'dccv']
, [271,21,271,60,'dccv']
, [272,17,272,18,'dccv']
, [265,48,265,50,'dccv']
, [274,17,274,24,'dccv']
, [274,54,274,80,'dccv']
, [274,26,274,50,'dccv']
, [275,17,275,18,'dccv']
, [276,21,276,66,'dccv']
, [277,21,277,56,'dccv']
, [278,21,278,37,'dccv']
, [279,21,279,59,'dccv']
, [280,17,280,18,'dccv']
, [274,51,274,53,'dccv']
, [281,13,281,14,'dccv']
, [286,9,286,10,'dccv']
, [328,9,328,10,'dccv']
, [330,13,330,14,'dccv']
, [331,17,331,59,'dccv']
, [332,17,332,74,'dccv']
, [333,17,333,75,'dccv']
, [334,17,334,39,'dccv']
, [336,17,336,55,'dccv']
, [338,17,338,47,'dccv']
, [339,17,339,41,'dccv']
, [340,17,340,63,'dccv']
, [341,13,341,14,'dccv']
, [346,9,346,10,'dccv']
, [365,9,365,10,'dccv']
, [366,13,366,42,'dccv']
, [372,13,372,14,'dccv']
, [373,17,373,70,'dccv']
, [375,17,375,53,'dccv']
, [376,17,376,18,'dccv']
, [377,21,377,61,'dccv']
, [378,21,378,47,'dccv']
, [379,17,379,18,'dccv']
, [380,22,380,59,'dccv']
, [381,17,381,18,'dccv']
, [382,21,382,62,'dccv']
, [383,21,383,48,'dccv']
, [384,17,384,18,'dccv']
, [385,13,385,14,'dccv']
, [390,9,390,10,'dccv']
, [394,9,394,10,'dccv']
, [396,13,396,14,'dccv']
, [397,17,397,58,'dccv']
, [398,17,398,44,'dccv']
, [400,17,400,46,'dccv']
, [401,17,401,67,'dccv']
, [402,13,402,14,'dccv']
, [407,9,407,10,'dccv']
, [410,9,410,10,'dccv']
, [412,13,412,14,'dccv']
, [413,17,413,59,'dccv']
, [415,17,415,43,'dccv']
, [416,17,416,18,'dccv']
, [417,21,417,65,'dccv']
, [418,21,418,22,'dccv']
, [419,25,419,103,'dccv']
, [421,25,421,69,'dccv']
, [422,25,422,26,'dccv']
, [423,29,423,108,'dccv']
, [424,29,424,87,'dccv']
, [425,29,425,50,'dccv']
, [426,25,426,26,'dccv']
, [427,21,427,22,'dccv']
, [429,21,429,22,'dccv']
, [430,25,430,104,'dccv']
, [431,25,431,83,'dccv']
, [432,25,432,45,'dccv']
, [434,25,434,103,'dccv']
, [435,25,435,87,'dccv']
, [437,25,437,63,'dccv']
, [438,25,438,26,'dccv']
, [439,29,439,98,'dccv']
, [441,29,441,83,'dccv']
, [442,29,442,50,'dccv']
, [443,25,443,26,'dccv']
, [444,21,444,22,'dccv']
, [445,17,445,18,'dccv']
, [446,13,446,14,'dccv']
, [451,9,451,10,'dccv']
, [454,9,454,10,'dccv']
, [456,13,456,14,'dccv']
, [457,17,457,59,'dccv']
, [459,17,459,43,'dccv']
, [486,13,486,14,'dccv']
, [491,9,491,10,'dccv']
, [494,9,494,10,'dccv']
, [495,13,502,15,'dccv']
, [504,13,504,54,'dccv']
, [506,13,506,39,'dccv']
, [508,13,508,29,'dccv']
, [512,9,512,10,'dccv']
, [42,13,42,37,'dcuc']
, [43,13,43,14,'dcuc']
, [44,17,44,53,'dcuc']
, [45,13,45,14,'dcuc']
, [75,9,75,10,'dcuc']
, [76,13,76,48,'dcuc']
, [77,9,77,10,'dcuc']
, [85,9,85,10,'dcuc']
, [86,13,86,67,'dcuc']
, [87,9,87,10,'dcuc']
, [99,13,99,14,'dcuc']
, [100,17,100,24,'dcuc']
, [111,21,111,22,'dcuc']
, [112,25,112,38,'dcuc']
, [113,25,113,59,'dcuc']
, [114,25,114,45,'dcuc']
, [115,21,115,22,'dcuc']
, [134,13,134,37,'dcuc']
, [135,13,135,14,'dcuc']
, [136,17,136,53,'dcuc']
, [137,13,137,14,'dcuc']
, [146,9,146,10,'dcuc']
, [148,13,148,14,'dcuc']
, [149,17,149,24,'dcuc']
, [149,51,149,77,'dcuc']
, [149,26,149,47,'dcuc']
, [150,17,150,18,'dcuc']
, [151,21,151,66,'dcuc']
, [152,21,152,51,'dcuc']
, [153,21,153,22,'dcuc']
, [154,25,154,39,'dcuc']
, [155,25,155,31,'dcuc']
, [157,17,157,18,'dcuc']
, [149,48,149,50,'dcuc']
, [158,13,158,14,'dcuc']
, [159,13,159,37,'dcuc']
, [160,13,160,14,'dcuc']
, [161,17,161,53,'dcuc']
, [162,13,162,14,'dcuc']
, [163,9,163,10,'dcuc']
, [194,21,194,22,'dcuc']
, [195,25,195,67,'dcuc']
, [196,25,196,59,'dcuc']
, [197,21,197,22,'dcuc']
, [225,13,225,37,'dcuc']
, [226,13,226,14,'dcuc']
, [227,17,227,53,'dcuc']
, [228,13,228,14,'dcuc']
, [251,13,251,37,'dcuc']
, [252,13,252,14,'dcuc']
, [253,17,253,53,'dcuc']
, [254,13,254,14,'dcuc']
, [282,13,282,37,'dcuc']
, [283,13,283,14,'dcuc']
, [284,17,284,53,'dcuc']
, [285,13,285,14,'dcuc']
, [293,9,293,10,'dcuc']
, [295,13,295,14,'dcuc']
, [296,22,296,36,'dcuc']
, [297,17,297,18,'dcuc']
, [298,21,298,62,'dcuc']
, [299,21,299,62,'dcuc']
, [300,21,300,22,'dcuc']
, [301,25,301,34,'dcuc']
, [303,21,306,23,'dcuc']
, [307,21,307,57,'dcuc']
, [308,17,308,18,'dcuc']
, [296,70,296,77,'dcuc']
, [296,37,296,68,'dcuc']
, [309,13,309,14,'dcuc']
, [310,13,310,37,'dcuc']
, [311,13,311,14,'dcuc']
, [312,17,312,53,'dcuc']
, [313,13,313,14,'dcuc']
, [314,9,314,10,'dcuc']
, [322,9,322,10,'dcuc']
, [323,9,323,10,'dcuc']
, [342,13,342,37,'dcuc']
, [343,13,343,14,'dcuc']
, [344,17,344,53,'dcuc']
, [345,13,345,14,'dcuc']
, [349,9,349,10,'dcuc']
, [351,13,351,14,'dcuc']
, [352,17,352,59,'dcuc']
, [353,17,353,41,'dcuc']
, [354,17,354,63,'dcuc']
, [355,17,355,55,'dcuc']
, [356,13,356,14,'dcuc']
, [357,13,357,37,'dcuc']
, [358,13,358,14,'dcuc']
, [359,17,359,53,'dcuc']
, [360,13,360,14,'dcuc']
, [361,9,361,10,'dcuc']
, [367,13,367,14,'dcuc']
, [368,17,368,24,'dcuc']
, [386,13,386,37,'dcuc']
, [387,13,387,14,'dcuc']
, [388,17,388,53,'dcuc']
, [389,13,389,14,'dcuc']
, [403,13,403,37,'dcuc']
, [404,13,404,14,'dcuc']
, [405,17,405,53,'dcuc']
, [406,13,406,14,'dcuc']
, [447,13,447,37,'dcuc']
, [448,13,448,14,'dcuc']
, [449,17,449,53,'dcuc']
, [450,13,450,14,'dcuc']
, [460,17,460,18,'dcuc']
, [461,21,461,65,'dcuc']
, [462,21,462,22,'dcuc']
, [463,25,463,103,'dcuc']
, [465,25,465,69,'dcuc']
, [466,25,466,26,'dcuc']
, [467,29,467,103,'dcuc']
, [468,29,468,50,'dcuc']
, [469,25,469,26,'dcuc']
, [470,21,470,22,'dcuc']
, [472,21,472,22,'dcuc']
, [473,25,473,99,'dcuc']
, [474,25,474,45,'dcuc']
, [476,25,476,103,'dcuc']
, [477,25,477,79,'dcuc']
, [479,25,479,55,'dcuc']
, [480,25,480,26,'dcuc']
, [481,29,481,85,'dcuc']
, [482,25,482,26,'dcuc']
, [483,25,483,46,'dcuc']
, [484,21,484,22,'dcuc']
, [485,17,485,18,'dcuc']
, [487,13,487,37,'dcuc']
, [488,13,488,14,'dcuc']
, [489,17,489,53,'dcuc']
, [490,13,490,14,'dcuc']
, [509,13,509,14,'dcuc']
, [510,17,510,41,'dcuc']
, [511,13,511,14,'dcuc']
];
		</script><link rel="stylesheet" type="text/css" href="../css/coverreport.css" />
	</head><body>
		<code id="src229" class="dotCoverSource"><pre>#region

using System;
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Media;
using AvalonDock;
using LGP.Components.Factory;
using LGP.Components.Factory.Interfaces.Component;
using LGP.Components.Factory.Interfaces.Module;
using LGP.Components.Factory.Publishers.Events;
using Microsoft.Practices.Prism.Events;

#endregion

namespace LGP.Components.Panels
{
    /// &lt;summary&gt;
    ///   Interaction logic for Panels.xaml
    /// &lt;/summary&gt;
    public partial class Panels : IPanel
    {
        private readonly ObservableCollection&lt; ExceptionLine &gt; _traceCollection = new ObservableCollection&lt; ExceptionLine &gt;();
        private DocumentContent _selectedMainComponentTab;
        private DockableContent _selectedSideComponentTab;

        /// &lt;summary&gt;
        ///   Constructor for panels
        /// &lt;/summary&gt;
        public Panels()
        {
            try
            {
                this.InitializeComponent();
                this.SideBarExplorer.Hide();
                this.BottomBar.Hide();

                ThemeFactory.ChangeTheme( new Uri( &quot;LGP.Components.Panels;component/Themes/lgp.xaml&quot; , UriKind.RelativeOrAbsolute ) );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        /// 
        /// &lt;/summary&gt;
        public ObservableCollection&lt; ExceptionLine &gt; TraceCollection
        {
            get
            {
                return this._traceCollection;
            }
        }

        #region IPanel Members

        /// &lt;summary&gt;
        ///   Subscribes subscriber events
        /// &lt;/summary&gt;
        public void SubscribeEvents()
        {
            Framework.EventBus.Subscribe&lt; MenuEvent &gt;( this.LoadInternalPane , ThreadOption.UIThread , true );
            Framework.EventBus.Subscribe&lt; Exception &gt;( this.HandleException , ThreadOption.UIThread , true );
        }

        /// &lt;summary&gt;
        ///   Gets the components name
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public string GetName()
        {
            return Properties.Resources.Panels;
        }


        /// &lt;summary&gt;
        ///   Gets the icon associated with this component
        /// &lt;/summary&gt;
        /// &lt;returns&gt;Image&lt;/returns&gt;
        public Image GetIcon()
        {
            return Framework.Images.GetImage( &quot;lgp&quot; , &quot;128x128&quot; );
        }


        /// &lt;summary&gt;
        ///   Requests the Panel realizer to add a User control to its display
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;control&quot;&gt;The user control&lt;/param&gt;
        /// &lt;param name = &quot;toolbarName&quot;&gt;The title on the toolbar header&lt;/param&gt;
        /// &lt;param name = &quot;image&quot;&gt;The image icon assoacited with the control&lt;/param&gt;
        public void AddSideComponent( UserControl control , string toolbarName , Image image )
        {
            if( control == null )
            {
                return;
            }
            try
            {
                Framework.EventBus.Publish( new PanelEvent( this ) );

                var shown = false;

                foreach( DockableContent tabEntry in this.SideBarExplorer.Items )
                {
                    if( tabEntry.Content == control )
                    {
                        shown = true;
                        tabEntry.Show( this.dockManager );
                        tabEntry.Activate();
                    }
                }

                if( control.Parent == null &amp;&amp; shown == false )
                {
                    var aSideBarcontrol = new DockableContent
                    {
                        Background = Brushes.White , Title = toolbarName , Icon = image.Source , Content = control , ToolTip = toolbarName , HideOnClose = false , IsLocked = false
                    };

                    aSideBarcontrol.Closing += this.ASideBarcontrolClosing;
                    this.SideBarExplorer.Items.Add( aSideBarcontrol );
                    aSideBarcontrol.Show( this.dockManager );
                    aSideBarcontrol.Activate();
                }

                control.Focus();
                control.BringIntoView();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Requests the Panel realizer to remove a User control from its display
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;control&quot;&gt;The control to remove&lt;/param&gt;
        public void RemoveSideComponent( UserControl control )
        {
            try
            {
                foreach( DocumentContent dCtrl in this.SideBarExplorer.Items )
                {
                    var cCtrl = ( ContentControl ) dCtrl.Content;
                    if( cCtrl.Content == control )
                    {
                        dCtrl.Close();
                        break;
                    }
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Adds a UserControl to the main component container
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;control&quot;&gt;UserControl element&lt;/param&gt;
        /// &lt;param name = &quot;controlTabTitle&quot;&gt;The title to give the tab element&lt;/param&gt;
        public void AddMainComponent( UserControl control , string controlTabTitle )
        {
            try
            {
                Framework.EventBus.Publish( new PanelEvent( this ) );

                var alreadyOpen = false;
                DocumentContent focusThis = null;

                foreach( DocumentContent cCtrl in this.MainComponentContainer.Items )
                {
                    if( cCtrl.Tag.ToString().CompareTo( controlTabTitle ) == 0 )
                    {
                        alreadyOpen = true;
                        focusThis = cCtrl;
                    }
                }

                if( alreadyOpen == false )
                {
                    var title = controlTabTitle;

                    if( controlTabTitle.Contains( &quot;\\&quot; ) )
                    {
                        var parts = controlTabTitle.Split( &#39;\\&#39; );
                        title = parts[ parts.Length - 1 ];
                    }

                    var newContentControl = new ContentControl
                    {
                        Margin = new Thickness( 0 ) , Content = control
                    };
                    var newDocumentContent = new DocumentContent
                    {
                        Title = title , Background = Brushes.White , Content = newContentControl , Icon = Framework.Images.GetImage( &quot;CutHS&quot; , &quot;VS2010ImageLibrary&quot; , 12 ).Source , Tag = controlTabTitle
                    };
                    newDocumentContent.Closing += this.NewDocumentContentClosing;

                    this.MainComponentContainer.Items.Add( newDocumentContent );
                    newDocumentContent.Show( this.dockManager );
                    newDocumentContent.Activate();
                }
                else
                {
                    focusThis.Show( this.dockManager );
                    focusThis.Activate();

                    var newWindow = ( IUserControl ) control;
                    newWindow.Dispose();
                }

                control.Focus();
                control.BringIntoView();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Requests the Panel realizer to remove a User control from its display
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;control&quot;&gt;UserControl element&lt;/param&gt;
        public void RemoveMainComponent( UserControl control )
        {
            try
            {
                foreach( DocumentContent dCtrl in this.MainComponentContainer.Items )
                {
                    var cCtrl = ( ContentControl ) dCtrl.Content;
                    if( cCtrl.Content == control )
                    {
                        dCtrl.Close();
                        GC.Collect();
                        break;
                    }
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Requests the Panel to update the panel tab names
        /// &lt;/summary&gt;
        public void UpdateTabNames()
        {
            try
            {
                foreach( DocumentContent dCtrl in this.MainComponentContainer.Items )
                {
                    var cCtrl = ( ContentControl ) dCtrl.Content;
                    var uCtrl = ( UserControl ) cCtrl.Content;
                    var iCtrl = ( IUserControl ) uCtrl;
                    iCtrl.Refresh();
                    dCtrl.Title = ( uCtrl ).Tag.ToString();
                }

                foreach( DockableContent tabEntry in this.SideBarExplorer.Items )
                {
                    var uCtrl = ( UserControl ) tabEntry.Content;
                    var iCtrl = ( IUserControl ) uCtrl;
                    iCtrl.Refresh();
                    tabEntry.Title = uCtrl.Tag.ToString();
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Load all side bar components provided by the modules
        /// &lt;/summary&gt;
        public void LoadSideBarComponents()
        {
            try
            {
                for( var index = 0; index &lt; Framework.Modules.Count; index++ )
                {
                    var control = Framework.Modules[ index ];
                    if( control.GetSidebarControl() == null )
                    {
                        continue;
                    }
                    var p = new DockableContent
                    {
                        Background = Brushes.White , Title = control.GetName() , Icon = control.GetIcon().Source , Content = control.GetSidebarControl()
                    };
                    this.SideBarExplorer.Items.Add( p );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Registers this components menu handlers
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;menu&quot;&gt;The program main menu&lt;/param&gt;
        public void RegisterMenuEntries( IMenu menu )
        {
        }

        #endregion

        private void NewDocumentContentClosing( object sender , CancelEventArgs e )
        {
            try
            {
                var dockable = ( DocumentContent ) sender;
                var contentControl = ( ContentControl ) dockable.Content;
                var userControl = ( IUserControl ) contentControl.Content;
                userControl.Dispose();

                this._selectedMainComponentTab = null;

                contentControl.Content = null;
                dockable.Content = null;
                this.SideBarExplorer.Items.Remove( dockable );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void ASideBarcontrolClosing( object sender , CancelEventArgs e )
        {
            try
            {
                var dockable = ( DockableContent ) sender;
                dockable.Content = null;
                this.SideBarExplorer.Items.Remove( dockable );
                this._selectedSideComponentTab = null;
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void LoadInternalPane( MenuEvent details )
        {
            if( details.Command == null )
            {
                return;
            }

            try
            {
                Framework.EventBus.Publish( new PanelEvent( this ) );

                if( details.Command == &quot;errorPane&quot; )
                {
                    this.errorPane.Show( this.dockManager );
                    this.errorPane.Activate();
                }
                else if( details.Command == &quot;outputPane&quot; )
                {
                    this.outputPane.Show( this.dockManager );
                    this.outputPane.Activate();
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void HandleException( Exception details )
        {
            try
            {
                this.outputPane.Show( this.dockManager );
                this.outputPane.Activate();

                this.AddException( details );
                this.listView1.ItemsSource = this.TraceCollection;
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void MainComponentContainerSelectionChanged( object sender , SelectionChangedEventArgs e )
        {
            try
            {
                var documentPane = sender as DocumentPane;

                if( documentPane != null )
                {
                    if( this._selectedMainComponentTab == null )
                    {
                        this._selectedMainComponentTab = documentPane.SelectedItem as DocumentContent;

                        if( this._selectedMainComponentTab != null )
                        {
                            var contentControl = ( ContentControl ) this._selectedMainComponentTab.Content;
                            var userControl = ( IUserControl ) contentControl.Content;
                            userControl.Resume();
                        }
                    }
                    else
                    {
                        var contentControl = ( ContentControl ) this._selectedMainComponentTab.Content;
                        var userControl = ( IUserControl ) contentControl.Content;
                        userControl.Pause();

                        this._selectedMainComponentTab = documentPane.SelectedItem as DocumentContent;
                        var selectedMainComponentTab = this._selectedMainComponentTab;

                        if( selectedMainComponentTab != null )
                        {
                            contentControl = ( ContentControl ) selectedMainComponentTab.Content;

                            userControl = ( IUserControl ) contentControl.Content;
                            userControl.Resume();
                        }
                    }
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void SideBarExplorerSelectionChanged( object sender , SelectionChangedEventArgs e )
        {
            try
            {
                var documentPane = sender as DocumentPane;

                if( documentPane != null )
                {
                    if( this._selectedMainComponentTab == null )
                    {
                        this._selectedSideComponentTab = documentPane.SelectedItem as DockableContent;

                        if( this._selectedSideComponentTab != null )
                        {
                            var userControl = ( IUserControl ) this._selectedSideComponentTab.Content;
                            userControl.Resume();
                        }
                    }
                    else
                    {
                        var userControl = ( IUserControl ) this._selectedSideComponentTab.Content;
                        userControl.Pause();

                        this._selectedSideComponentTab = documentPane.SelectedItem as DockableContent;
                        var sideComponentTab = this._selectedSideComponentTab;

                        if( sideComponentTab != null )
                        {
                            userControl = ( IUserControl ) sideComponentTab.Content;
                        }
                        userControl.Resume();
                    }
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void AddException( Exception e )
        {
            var item = new ExceptionLine
            {
                Message = e.Message ,
                ExceptionType = e.GetType().Name ,
                Source = e.Source ,
                StackTrace = e.StackTrace ,
                TargetSite = e.TargetSite.Name
            };

            this._traceCollection.Insert( 0 , item );

            var ie = e.InnerException;

            if( ie != null )
            {
                this.AddException( ie );
            }
        }

        #region Nested type: ExceptionLine

        /// &lt;summary&gt;
        /// 
        /// &lt;/summary&gt;
        public class ExceptionLine
        {
            /// &lt;summary&gt;
            /// 
            /// &lt;/summary&gt;
            public string Message
            {
                get;
                set;
            }

            /// &lt;summary&gt;
            /// 
            /// &lt;/summary&gt;
            public string ExceptionType
            {
                get;
                set;
            }

            /// &lt;summary&gt;
            /// 
            /// &lt;/summary&gt;
            public string Source
            {
                get;
                set;
            }

            /// &lt;summary&gt;
            /// 
            /// &lt;/summary&gt;
            public string StackTrace
            {
                get;
                set;
            }

            /// &lt;summary&gt;
            /// 
            /// &lt;/summary&gt;
            public string TargetSite
            {
                get;
                set;
            }
        }

        #endregion
    }
}</pre></code><script type="text/javascript">
			applyranges('src229', RANGES_229)
		</script>
	</body>
</html>