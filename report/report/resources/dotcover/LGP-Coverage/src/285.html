<html>
	<head>
		<script type="text/javascript" src="../js/coverreport.js">

		</script><script type="text/javascript">
			RANGES_285 = [
   [48,9,48,73,'dccv']
, [49,9,49,10,'dccv']
, [51,13,51,14,'dccv']
, [52,17,52,44,'dccv']
, [53,17,53,35,'dccv']
, [54,17,54,31,'dccv']
, [55,17,55,39,'dccv']
, [56,17,56,35,'dccv']
, [57,17,57,39,'dccv']
, [58,17,58,32,'dccv']
, [59,13,59,14,'dccv']
, [64,9,64,10,'dccv']
, [74,9,74,10,'dccv']
, [75,13,75,33,'dccv']
, [80,13,80,14,'dccv']
, [81,17,81,31,'dccv']
, [82,17,82,61,'dccv']
, [83,13,83,14,'dccv']
, [88,9,88,10,'dccv']
, [143,9,143,10,'dccv']
, [145,13,145,14,'dccv']
, [146,17,146,36,'dccv']
, [147,17,147,56,'dccv']
, [148,17,148,48,'dccv']
, [149,13,149,14,'dccv']
, [154,9,154,10,'dccv']
, [159,9,159,10,'dccv']
, [161,13,161,14,'dccv']
, [162,17,162,34,'dccv']
, [164,17,164,38,'dccv']
, [168,22,168,62,'dccv']
, [169,17,169,18,'dccv']
, [170,21,170,35,'dccv']
, [171,17,171,18,'dccv']
, [172,22,172,63,'dccv']
, [173,17,173,18,'dccv']
, [174,21,174,35,'dccv']
, [175,17,175,18,'dccv']
, [181,17,181,80,'dccv']
, [182,17,182,51,'dccv']
, [183,17,183,52,'dccv']
, [184,17,184,46,'dccv']
, [185,17,185,47,'dccv']
, [186,17,186,80,'dccv']
, [187,17,187,61,'dccv']
, [188,17,188,49,'dccv']
, [189,17,189,66,'dccv']
, [190,17,190,49,'dccv']
, [192,17,192,182,'dccv']
, [194,17,194,52,'dccv']
, [195,17,195,35,'dccv']
, [196,17,196,18,'dccv']
, [197,21,197,61,'dccv']
, [198,21,198,59,'dccv']
, [199,21,199,94,'dccv']
, [201,21,201,57,'dccv']
, [202,21,202,62,'dccv']
, [203,21,203,107,'dccv']
, [205,21,205,57,'dccv']
, [206,21,206,60,'dccv']
, [207,21,207,97,'dccv']
, [209,21,209,57,'dccv']
, [210,21,210,62,'dccv']
, [211,21,211,101,'dccv']
, [213,21,213,55,'dccv']
, [214,21,214,86,'dccv']
, [215,17,215,18,'dccv']
, [216,13,216,14,'dccv']
, [221,9,221,10,'dccv']
, [224,9,224,10,'dccv']
, [225,13,225,51,'dccv']
, [226,13,226,113,'dccv']
, [227,9,227,10,'dccv']
, [231,9,231,10,'dccv']
, [233,13,233,14,'dccv']
, [234,17,234,51,'dccv']
, [235,17,235,76,'dccv']
, [236,13,236,14,'dccv']
, [241,9,241,10,'dccv']
, [249,9,249,10,'dccv']
, [250,13,250,29,'dccv']
, [251,9,251,10,'dccv']
, [266,9,266,10,'dccv']
, [267,13,267,71,'dccv']
, [268,13,268,14,'dccv']
, [269,17,269,45,'dccv']
, [270,13,270,14,'dccv']
, [272,13,272,14,'dccv']
, [273,17,273,65,'dccv']
, [274,17,274,41,'dccv']
, [275,17,275,39,'dccv']
, [276,13,276,14,'dccv']
, [281,9,281,10,'dccv']
, [287,9,287,10,'dccv']
, [289,13,289,14,'dccv']
, [290,17,290,67,'dccv']
, [291,17,291,41,'dccv']
, [292,17,292,40,'dccv']
, [293,13,293,14,'dccv']
, [298,9,298,10,'dccv']
, [305,9,305,10,'dccv']
, [307,13,307,14,'dccv']
, [308,17,308,34,'dccv']
, [310,17,310,34,'dccv']
, [311,17,311,18,'dccv']
, [312,21,312,35,'dccv']
, [313,17,313,18,'dccv']
, [314,22,314,54,'dccv']
, [315,17,315,18,'dccv']
, [316,21,316,35,'dccv']
, [317,17,317,18,'dccv']
, [318,22,318,55,'dccv']
, [319,17,319,18,'dccv']
, [320,21,320,35,'dccv']
, [321,17,321,18,'dccv']
, [322,22,322,40,'dccv']
, [323,17,323,18,'dccv']
, [324,21,324,36,'dccv']
, [325,17,325,18,'dccv']
, [327,17,327,47,'dccv']
, [328,17,328,48,'dccv']
, [329,17,329,80,'dccv']
, [330,17,330,42,'dccv']
, [331,17,331,43,'dccv']
, [332,13,332,14,'dccv']
, [337,9,337,10,'dccv']
, [341,9,341,10,'dccv']
, [343,13,343,14,'dccv']
, [344,17,344,31,'dccv']
, [345,17,345,71,'dccv']
, [347,17,347,40,'dccv']
, [348,17,348,18,'dccv']
, [349,21,349,61,'dccv']
, [350,21,350,83,'dccv']
, [351,17,351,18,'dccv']
, [352,13,352,14,'dccv']
, [357,9,357,10,'dccv']
, [361,9,361,10,'dccv']
, [363,13,363,14,'dccv']
, [364,17,364,46,'dccv']
, [365,17,365,75,'dccv']
, [366,17,366,39,'dccv']
, [367,17,367,38,'dccv']
, [368,17,368,39,'dccv']
, [369,13,369,14,'dccv']
, [374,9,374,10,'dccv']
, [378,9,378,10,'dccv']
, [380,13,380,14,'dccv']
, [381,17,381,46,'dccv']
, [382,17,382,75,'dccv']
, [383,17,383,39,'dccv']
, [384,17,384,38,'dccv']
, [385,17,385,39,'dccv']
, [386,13,386,14,'dccv']
, [391,9,391,10,'dccv']
, [395,9,395,10,'dccv']
, [397,13,397,14,'dccv']
, [398,17,398,46,'dccv']
, [399,17,399,73,'dccv']
, [400,17,400,39,'dccv']
, [401,17,401,38,'dccv']
, [402,17,402,39,'dccv']
, [403,13,403,14,'dccv']
, [408,9,408,10,'dccv']
, [412,9,412,10,'dccv']
, [414,13,414,14,'dccv']
, [415,17,415,46,'dccv']
, [416,17,416,83,'dccv']
, [417,17,417,39,'dccv']
, [418,17,418,38,'dccv']
, [419,17,419,39,'dccv']
, [420,13,420,14,'dccv']
, [425,9,425,10,'dccv']
, [433,9,433,10,'dccv']
, [434,13,434,30,'dccv']
, [437,13,437,14,'dccv']
, [438,17,438,99,'dccv']
, [439,17,439,18,'dccv']
, [440,21,440,100,'dccv']
, [441,21,441,39,'dccv']
, [447,21,447,102,'dccv']
, [448,21,448,39,'dccv']
, [454,21,454,110,'dccv']
, [455,21,455,39,'dccv']
, [456,21,456,22,'dccv']
, [457,25,457,72,'dccv']
, [458,25,458,43,'dccv']
, [459,21,459,22,'dccv']
, [461,21,461,43,'dccv']
, [462,17,462,18,'dccv']
, [463,13,463,14,'dccv']
, [468,9,468,10,'dccv']
, [476,9,476,10,'dccv']
, [477,13,477,42,'dccv']
, [479,13,479,43,'dccv']
, [480,13,480,14,'dccv']
, [481,17,481,24,'dccv']
, [484,13,484,14,'dccv']
, [485,17,485,58,'dccv']
, [486,13,486,14,'dccv']
, [491,9,491,10,'dccv']
, [31,9,31,36,'dcuc']
, [32,9,32,10,'dcuc']
, [34,13,34,14,'dcuc']
, [35,17,35,44,'dcuc']
, [36,13,36,14,'dcuc']
, [37,13,37,37,'dcuc']
, [38,13,38,14,'dcuc']
, [39,17,39,53,'dcuc']
, [40,13,40,14,'dcuc']
, [41,9,41,10,'dcuc']
, [60,13,60,37,'dcuc']
, [61,13,61,14,'dcuc']
, [62,17,62,53,'dcuc']
, [63,13,63,14,'dcuc']
, [76,13,76,14,'dcuc']
, [77,17,77,24,'dcuc']
, [84,13,84,37,'dcuc']
, [85,13,85,14,'dcuc']
, [86,17,86,53,'dcuc']
, [87,13,87,14,'dcuc']
, [96,9,96,10,'dcuc']
, [98,13,98,14,'dcuc']
, [99,13,99,14,'dcuc']
, [100,13,100,37,'dcuc']
, [101,13,101,14,'dcuc']
, [102,17,102,53,'dcuc']
, [103,13,103,14,'dcuc']
, [104,9,104,10,'dcuc']
, [112,9,112,10,'dcuc']
, [114,13,114,14,'dcuc']
, [115,13,115,14,'dcuc']
, [116,13,116,37,'dcuc']
, [117,13,117,14,'dcuc']
, [118,17,118,53,'dcuc']
, [119,13,119,14,'dcuc']
, [120,9,120,10,'dcuc']
, [127,9,127,10,'dcuc']
, [129,13,129,14,'dcuc']
, [130,13,130,14,'dcuc']
, [131,13,131,37,'dcuc']
, [132,13,132,14,'dcuc']
, [133,17,133,53,'dcuc']
, [134,13,134,14,'dcuc']
, [135,9,135,10,'dcuc']
, [150,13,150,37,'dcuc']
, [151,13,151,14,'dcuc']
, [152,17,152,53,'dcuc']
, [153,13,153,14,'dcuc']
, [165,17,165,18,'dcuc']
, [166,21,166,35,'dcuc']
, [167,17,167,18,'dcuc']
, [176,22,176,44,'dcuc']
, [177,17,177,18,'dcuc']
, [178,21,178,36,'dcuc']
, [179,17,179,18,'dcuc']
, [217,13,217,37,'dcuc']
, [218,13,218,14,'dcuc']
, [219,17,219,53,'dcuc']
, [220,13,220,14,'dcuc']
, [237,13,237,37,'dcuc']
, [238,13,238,14,'dcuc']
, [239,17,239,53,'dcuc']
, [240,13,240,14,'dcuc']
, [258,9,258,10,'dcuc']
, [259,13,259,35,'dcuc']
, [260,9,260,10,'dcuc']
, [277,13,277,37,'dcuc']
, [278,13,278,14,'dcuc']
, [279,17,279,53,'dcuc']
, [280,13,280,14,'dcuc']
, [294,13,294,37,'dcuc']
, [295,13,295,14,'dcuc']
, [296,17,296,53,'dcuc']
, [297,13,297,14,'dcuc']
, [333,13,333,37,'dcuc']
, [334,13,334,14,'dcuc']
, [335,17,335,53,'dcuc']
, [336,13,336,14,'dcuc']
, [353,13,353,37,'dcuc']
, [354,13,354,14,'dcuc']
, [355,17,355,53,'dcuc']
, [356,13,356,14,'dcuc']
, [370,13,370,37,'dcuc']
, [371,13,371,14,'dcuc']
, [372,17,372,53,'dcuc']
, [373,13,373,14,'dcuc']
, [387,13,387,37,'dcuc']
, [388,13,388,14,'dcuc']
, [389,17,389,53,'dcuc']
, [390,13,390,14,'dcuc']
, [404,13,404,37,'dcuc']
, [405,13,405,14,'dcuc']
, [406,17,406,53,'dcuc']
, [407,13,407,14,'dcuc']
, [421,13,421,37,'dcuc']
, [422,13,422,14,'dcuc']
, [423,17,423,53,'dcuc']
, [424,13,424,14,'dcuc']
, [442,21,442,22,'dcuc']
, [443,25,443,74,'dcuc']
, [444,25,444,43,'dcuc']
, [445,21,445,22,'dcuc']
, [449,21,449,22,'dcuc']
, [450,25,450,74,'dcuc']
, [451,25,451,43,'dcuc']
, [452,21,452,22,'dcuc']
, [464,13,464,37,'dcuc']
, [465,13,465,14,'dcuc']
, [466,17,466,53,'dcuc']
, [467,13,467,14,'dcuc']
, [487,13,487,37,'dcuc']
, [488,13,488,14,'dcuc']
, [489,17,489,53,'dcuc']
, [490,13,490,14,'dcuc']
, [498,9,498,10,'dcuc']
, [499,13,499,35,'dcuc']
, [500,9,500,10,'dcuc']
];
		</script><link rel="stylesheet" type="text/css" href="../css/coverreport.css" />
	</head><body>
		<code id="src285" class="dotCoverSource"><pre>#region

using System;
using System.Reflection;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;
using System.Windows.Media;
using LGP.Components.Factory;
using LGP.Components.Factory.Interfaces.Database;
using LGP.Modules.OrganizationUnitExplorer.Internal.Modals.Controls;
using LGP.Modules.OrganizationUnitExplorer.Internal.NodeViews;

#endregion

namespace LGP.Modules.OrganizationUnitExplorer.Internal.CustomControls
{
    /// &lt;summary&gt;
    ///   Interaction logic for WrapPanelOuElement.xaml
    /// &lt;/summary&gt;
    public partial class WrapPanelOuElement : IOuObserver
    {
        private static WrapPanelOuElement _selectedElement;
        private readonly OuViewer _parent;
        private readonly int _size;
        private IOu _ou;
        private bool _selected;

        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        public WrapPanelOuElement()
        {
            try
            {
                this.InitializeComponent();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;ou&quot;&gt;&lt;/param&gt;
        /// &lt;param name = &quot;size&quot;&gt;&lt;/param&gt;
        /// &lt;param name = &quot;parent&quot;&gt;&lt;/param&gt;
        public WrapPanelOuElement( IOu ou , int size , OuViewer parent )
        {
            try
            {
                this.InitializeComponent();
                ou.Attach( this );
                this._ou = ou;
                this._parent = parent;
                this._size = size;
                this.AllowDrop = true;
                this.Prepare();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        #region IOuObserver Members

        /// &lt;summary&gt;
        ///   Update this observer with a refernece to the ou
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;ou&quot;&gt;Iou&lt;/param&gt;
        /// &lt;param name = &quot;source&quot;&gt;source observer&lt;/param&gt;
        public void Update( IOu ou , IOuObserver source )
        {
            if( this == source )
            {
                return;
            }
            try
            {
                this._ou = ou;
                this.ItemLabel.Content = this._ou.GetName();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Attach objewcts that observer this IOu
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IOuObserver&lt;/param&gt;
        public void Attach( IOuObserver obj )
        {
            try
            {
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Detach objewcts that observer this IOu
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IOuObserver&lt;/param&gt;
        public void Detach( IOuObserver obj )
        {
            try
            {
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Notify observers of this IOu
        /// &lt;/summary&gt;
        public void Notify()
        {
            try
            {
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Dispose this object and all the observers
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IOuObserver&lt;/param&gt;
        public void Dispose( IOuObserver obj )
        {
            try
            {
                obj.Detach( this );
                var parent = ( WrapPanel ) this.Parent;
                parent.Children.Remove( this );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        #endregion

        private void Prepare()
        {
            try
            {
                var fakeSize = 0;

                if( this._size &lt; 40 )
                {
                    fakeSize = 32;
                }
                else if( this._size &lt; 56 &amp;&amp; this._size &gt; 40 )
                {
                    fakeSize = 48;
                }
                else if( this._size &lt; 90 &amp;&amp; this._size &gt;= 56 )
                {
                    fakeSize = 64;
                }
                else if( this._size &gt;= 90 )
                {
                    fakeSize = 128;
                }

                this.ItemImage.Source = this._ou.GetOuImage( fakeSize ).Source;
                this.ItemImage.Width = this._size;
                this.ItemImage.Height = this._size;
                this.Width = this._size + 58;
                this.Height = this._size + 48;
                this.ItemImage.Source = this._ou.GetOuImage( fakeSize ).Source;
                this.ItemLabel.Content = this._ou.GetName();
                this.ItemLabel.AllowDrop = true;
                this.ItemImage.MouseDown += this.EntityMouseDown;
                this.ItemImage.AllowDrop = true;

                var resource = Framework.Utils.LoadResource( Assembly.GetExecutingAssembly() , &quot;LGP.Modules.OrganizationUnitExplorer.Internal.ContextMenuItems.OuContextMenu.xaml&quot; );

                var menu = resource as ContextMenu;
                if( menu != null )
                {
                    var item = ( MenuItem ) menu.Items[ 0 ];
                    item.Click += this.AddOuMenuItemClick;
                    item.Icon = Framework.Images.GetImage( &quot;workgroup&quot; , &quot;distros/32&quot; , 12 );

                    item = ( MenuItem ) menu.Items[ 1 ];
                    item.Click += this.RenameOuMenuItemClick;
                    item.Icon = Framework.Images.GetImage( &quot;RenameFolderHS&quot; , &quot;VS2010ImageLibrary&quot; , 12 );

                    item = ( MenuItem ) menu.Items[ 2 ];
                    item.Click += this.MoveOuMenuItemClick;
                    item.Icon = Framework.Images.GetImage( &quot;Move&quot; , &quot;VS2010ImageLibrary&quot; , 12 );

                    item = ( MenuItem ) menu.Items[ 3 ];
                    item.Click += this.DeleteOuMenuItemClick;
                    item.Icon = Framework.Images.GetImage( &quot;DeleteHS&quot; , &quot;VS2010ImageLibrary&quot; , 12 );

                    this.ItemImage.ContextMenu = menu;
                    this.ItemImage.ContextMenuOpening += this.MenuContextMenuOpening;
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void MenuContextMenuOpening( object sender , ContextMenuEventArgs e )
        {
            var menu = this.ItemImage.ContextMenu;
            Framework.ContextMenus.AttachMenuItemRegistrations( ref menu , typeof( IOu ) , this.MenuItemClick );
        }


        private void MenuItemClick( object sender , RoutedEventArgs e )
        {
            try
            {
                var menuitem = sender as MenuItem;
                Framework.ContextMenus.CallBack( menuitem , this.GetOu() );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Get the ou associated with this wrapper
        /// &lt;/summary&gt;
        /// &lt;returns&gt;IOu&lt;/returns&gt;
        public IOu GetOu()
        {
            return this._ou;
        }


        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public bool IsSelected()
        {
            return this._selected;
        }


        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        public void Select()
        {
            if( _selectedElement != null &amp;&amp; _selectedElement != this )
            {
                _selectedElement.DeSelect();
            }
            try
            {
                this.ItemBorder.BorderBrush = Brushes.LightBlue;
                _selectedElement = this;
                this._selected = true;
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        public void DeSelect()
        {
            try
            {
                this.ItemBorder.BorderBrush = Brushes.Transparent;
                _selectedElement = null;
                this._selected = false;
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;resize&quot;&gt;&lt;/param&gt;
        public void Resize( int resize )
        {
            try
            {
                var fakeSize = 0;

                if( resize &lt; 40 )
                {
                    fakeSize = 32;
                }
                else if( resize &lt; 56 &amp;&amp; resize &gt; 40 )
                {
                    fakeSize = 48;
                }
                else if( resize &lt; 90 &amp;&amp; resize &gt;= 56 )
                {
                    fakeSize = 64;
                }
                else if( resize &gt;= 90 )
                {
                    fakeSize = 128;
                }

                this.ItemImage.Width = resize;
                this.ItemImage.Height = resize;
                this.ItemImage.Source = this._ou.GetOuImage( fakeSize ).Source;
                this.Width = resize + 58;
                this.Height = resize + 48;
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void EntityMouseDown( object sender , MouseButtonEventArgs e )
        {
            try
            {
                this.Select();
                this._parent.SetDetailsPane( new OuPane( this._ou ) );

                if( e.ClickCount == 2 )
                {
                    var ouViewer = new OuViewer( this._ou );
                    Framework.Panels.AddMainComponent( ouViewer , ouViewer.Name );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void AddOuMenuItemClick( object sender , RoutedEventArgs e )
        {
            try
            {
                var popup = Framework.Dialog;
                var cou = new CreateOu( this._parent , this._ou , popup );
                popup.SetChild( cou );
                popup.ShowBlocking();
                this._parent.Update();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void RenameOuMenuItemClick( object sender , RoutedEventArgs e )
        {
            try
            {
                var popup = Framework.Dialog;
                var cou = new RenameOu( this._parent , this._ou , popup );
                popup.SetChild( cou );
                popup.ShowBlocking();
                this._parent.Update();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void MoveOuMenuItemClick( object sender , RoutedEventArgs e )
        {
            try
            {
                var popup = Framework.Dialog;
                var cou = new MoveOu( this._parent , this._ou , popup );
                popup.SetChild( cou );
                popup.ShowBlocking();
                this._parent.Update();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void DeleteOuMenuItemClick( object sender , RoutedEventArgs e )
        {
            try
            {
                var popup = Framework.Dialog;
                var cou = new DeleteOu( this._parent , this._ou , popup , false );
                popup.SetChild( cou );
                popup.ShowBlocking();
                this._parent.Update();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Invoked when an unhandled &lt;see cref = &quot;E:System.Windows.DragDrop.DragEnter&quot; /&gt;&nbsp;attached event reaches an element in its route that is derived from this class. Implement this method to add class handling for this event.
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;e&quot;&gt;The &lt;see cref = &quot;T:System.Windows.DragEventArgs&quot; /&gt; that contains the event data.&lt;/param&gt;
        protected override void OnDrop( DragEventArgs e )
        {
            base.OnDrop( e );

            try
            {
                if( e.Source == this || e.Source == this.ItemImage || e.Source == this.ItemLabel )
                {
                    var ele1 = ( TreeViewOuElement ) e.Data.GetData( typeof( TreeViewOuElement ) );
                    if( ele1 != null )
                    {
                        ele1.GetOu().SetParentOuId( this._ou.GetOuId() );
                        this._ou.Notify();
                    }

                    var ele2 = ( WrapPanelOuElement ) e.Data.GetData( typeof( WrapPanelOuElement ) );
                    if( ele2 != null )
                    {
                        ele2.GetOu().SetParentOuId( this._ou.GetOuId() );
                        this._ou.Notify();
                    }

                    var ele3 = ( WrapPanelClientElement ) e.Data.GetData( typeof( WrapPanelClientElement ) );
                    if( ele3 != null )
                    {
                        ele3.GetClient().Setouid( this._ou.GetOuId() );
                        this._ou.Notify();
                    }

                    this._parent.Update();
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Invoked when an unhandled &lt;see cref = &quot;E:System.Windows.Input.Mouse.PreviewMouseMove&quot; /&gt;&nbsp;attached event reaches an element in its route that is derived from this class. Implement this method to add class handling for this event.
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;e&quot;&gt;The &lt;see cref = &quot;T:System.Windows.Input.MouseEventArgs&quot; /&gt; that contains the event data.&lt;/param&gt;
        protected override void OnPreviewMouseMove( MouseEventArgs e )
        {
            base.OnPreviewMouseMove( e );

            if( this != _selectedElement )
            {
                return;
            }
            try
            {
                Framework.DragDrop.StartDrag( this , e );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        /// 
        /// &lt;/summary&gt;
        public void Update()
        {
            this._parent.Update();
        }
    }
}</pre></code><script type="text/javascript">
			applyranges('src285', RANGES_285)
		</script>
	</body>
</html>