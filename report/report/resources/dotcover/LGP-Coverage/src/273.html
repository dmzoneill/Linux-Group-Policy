<html>
	<head>
		<script type="text/javascript" src="../js/coverreport.js">

		</script><script type="text/javascript">
			RANGES_273 = [
   [48,9,48,34,'dccv']
, [49,9,49,10,'dccv']
, [51,13,51,14,'dccv']
, [52,17,52,44,'dccv']
, [54,17,54,50,'dccv']
, [56,17,56,35,'dccv']
, [58,17,58,42,'dccv']
, [59,17,59,41,'dccv']
, [60,17,60,31,'dccv']
, [62,17,62,37,'dccv']
, [63,17,63,37,'dccv']
, [65,17,65,114,'dccv']
, [66,17,66,109,'dccv']
, [67,17,67,114,'dccv']
, [68,17,68,109,'dccv']
, [69,17,69,120,'dccv']
, [70,17,70,118,'dccv']
, [71,17,71,72,'dccv']
, [73,17,73,182,'dccv']
, [75,17,75,52,'dccv']
, [76,17,76,35,'dccv']
, [77,17,77,18,'dccv']
, [78,21,78,61,'dccv']
, [79,21,79,57,'dccv']
, [80,21,80,94,'dccv']
, [81,21,81,47,'dccv']
, [82,21,82,56,'dccv']
, [84,21,84,57,'dccv']
, [85,21,85,60,'dccv']
, [86,21,86,107,'dccv']
, [87,21,87,47,'dccv']
, [88,21,88,56,'dccv']
, [90,21,90,57,'dccv']
, [91,21,91,58,'dccv']
, [92,21,92,97,'dccv']
, [93,21,93,47,'dccv']
, [94,21,94,56,'dccv']
, [96,21,96,57,'dccv']
, [97,21,97,60,'dccv']
, [98,21,98,101,'dccv']
, [99,21,99,47,'dccv']
, [100,21,100,56,'dccv']
, [101,17,101,18,'dccv']
, [103,17,103,59,'dccv']
, [104,17,104,51,'dccv']
, [105,13,105,14,'dccv']
, [110,9,110,10,'dccv']
, [120,9,120,10,'dccv']
, [121,13,121,33,'dccv']
, [127,13,127,14,'dccv']
, [128,17,128,31,'dccv']
, [129,17,129,48,'dccv']
, [130,17,130,59,'dccv']
, [131,17,131,47,'dccv']
, [132,17,132,51,'dccv']
, [133,17,133,89,'dccv']
, [134,13,134,14,'dccv']
, [139,9,139,10,'dccv']
, [209,9,209,10,'dccv']
, [211,13,211,14,'dccv']
, [212,17,212,51,'dccv']
, [213,17,213,72,'dccv']
, [214,13,214,14,'dccv']
, [219,9,219,10,'dccv']
, [222,9,222,10,'dccv']
, [224,13,224,14,'dccv']
, [225,17,225,52,'dccv']
, [226,17,226,18,'dccv']
, [227,21,227,28,'dccv']
, [227,57,227,78,'dccv']
, [227,30,227,53,'dccv']
, [228,21,228,22,'dccv']
, [229,25,229,53,'dccv']
, [230,21,230,22,'dccv']
, [227,54,227,56,'dccv']
, [232,21,232,51,'dccv']
, [233,17,233,18,'dccv']
, [235,17,235,52,'dccv']
, [236,17,236,18,'dccv']
, [237,21,237,28,'dccv']
, [237,61,237,82,'dccv']
, [237,30,237,57,'dccv']
, [238,21,238,22,'dccv']
, [239,25,239,57,'dccv']
, [240,21,240,22,'dccv']
, [237,58,237,60,'dccv']
, [242,21,242,51,'dccv']
, [243,17,243,18,'dccv']
, [244,13,244,14,'dccv']
, [251,13,251,14,'dccv']
, [252,17,252,80,'dccv']
, [254,17,254,34,'dccv']
, [255,17,255,18,'dccv']
, [256,26,256,36,'dccv']
, [257,21,257,22,'dccv']
, [258,25,258,84,'dccv']
, [259,25,259,58,'dccv']
, [260,21,260,22,'dccv']
, [256,52,256,55,'dccv']
, [256,37,256,50,'dccv']
, [262,21,262,106,'dccv']
, [263,17,263,18,'dccv']
, [268,13,268,14,'dccv']
, [275,13,275,14,'dccv']
, [276,17,276,89,'dccv']
, [278,17,278,38,'dccv']
, [279,17,279,18,'dccv']
, [280,26,280,36,'dccv']
, [281,21,281,22,'dccv']
, [282,25,282,92,'dccv']
, [283,25,283,58,'dccv']
, [284,21,284,22,'dccv']
, [280,56,280,59,'dccv']
, [280,37,280,54,'dccv']
, [285,21,285,106,'dccv']
, [286,17,286,18,'dccv']
, [291,13,291,14,'dccv']
, [296,9,296,10,'dccv']
, [303,9,303,10,'dccv']
, [305,13,305,14,'dccv']
, [306,17,306,67,'dccv']
, [307,17,307,18,'dccv']
, [308,21,308,97,'dccv']
, [309,21,309,22,'dccv']
, [310,25,310,90,'dccv']
, [311,25,311,61,'dccv']
, [312,21,312,22,'dccv']
, [314,21,314,93,'dccv']
, [315,21,315,22,'dccv']
, [316,25,316,82,'dccv']
, [317,25,317,49,'dccv']
, [318,21,318,22,'dccv']
, [319,17,319,18,'dccv']
, [320,17,320,61,'dccv']
, [321,13,321,14,'dccv']
, [326,9,326,10,'dccv']
, [330,9,330,10,'dccv']
, [331,13,331,33,'dccv']
, [332,13,332,47,'dccv']
, [333,9,333,10,'dccv']
, [337,9,337,10,'dccv']
, [338,13,338,33,'dccv']
, [339,13,339,47,'dccv']
, [340,9,340,10,'dccv']
, [344,9,344,10,'dccv']
, [346,13,346,14,'dccv']
, [347,17,347,46,'dccv']
, [348,17,348,37,'dccv']
, [349,13,349,14,'dccv']
, [354,9,354,10,'dccv']
, [357,9,357,10,'dccv']
, [359,13,359,14,'dccv']
, [360,17,360,46,'dccv']
, [362,17,362,96,'dccv']
, [363,17,363,18,'dccv']
, [364,21,364,41,'dccv']
, [365,17,365,18,'dccv']
, [366,22,366,101,'dccv']
, [370,13,370,14,'dccv']
, [375,9,375,10,'dccv']
, [393,9,393,10,'dccv']
, [395,13,395,14,'dccv']
, [396,17,396,46,'dccv']
, [397,17,397,37,'dccv']
, [398,13,398,14,'dccv']
, [403,9,403,10,'dccv']
, [407,9,407,10,'dccv']
, [409,13,409,14,'dccv']
, [410,17,410,46,'dccv']
, [412,17,412,96,'dccv']
, [416,22,416,101,'dccv']
, [420,13,420,14,'dccv']
, [425,9,425,10,'dccv']
, [429,9,429,10,'dccv']
, [431,13,431,14,'dccv']
, [432,17,432,24,'dccv']
, [432,43,432,64,'dccv']
, [432,26,432,39,'dccv']
, [433,17,433,18,'dccv']
, [434,21,434,66,'dccv']
, [435,17,435,18,'dccv']
, [432,40,432,42,'dccv']
, [437,17,437,24,'dccv']
, [437,43,437,64,'dccv']
, [437,26,437,39,'dccv']
, [438,17,438,18,'dccv']
, [439,21,439,70,'dccv']
, [440,17,440,18,'dccv']
, [437,40,437,42,'dccv']
, [441,13,441,14,'dccv']
, [446,9,446,10,'dccv']
, [450,9,450,10,'dccv']
, [452,13,452,14,'dccv']
, [453,17,453,63,'dccv']
, [454,17,454,18,'dccv']
, [455,21,455,128,'dccv']
, [456,21,456,70,'dccv']
, [457,21,457,55,'dccv']
, [459,21,459,36,'dccv']
, [464,21,464,67,'dccv']
, [465,17,465,18,'dccv']
, [466,13,466,14,'dccv']
, [471,9,471,10,'dccv']
, [475,9,475,10,'dccv']
, [477,13,477,14,'dccv']
, [478,17,478,63,'dccv']
, [479,17,479,18,'dccv']
, [480,21,480,128,'dccv']
, [481,21,481,70,'dccv']
, [482,21,482,55,'dccv']
, [484,21,484,36,'dccv']
, [489,21,489,67,'dccv']
, [490,17,490,18,'dccv']
, [491,13,491,14,'dccv']
, [496,9,496,10,'dccv']
, [500,9,500,10,'dccv']
, [502,13,502,14,'dccv']
, [503,17,503,46,'dccv']
, [504,17,504,67,'dccv']
, [505,17,505,39,'dccv']
, [506,17,506,38,'dccv']
, [507,17,507,89,'dccv']
, [508,13,508,14,'dccv']
, [513,9,513,10,'dccv']
, [516,9,516,10,'dccv']
, [518,13,518,14,'dccv']
, [519,17,519,76,'dccv']
, [520,17,520,61,'dccv']
, [521,17,521,69,'dccv']
, [522,17,522,89,'dccv']
, [523,13,523,14,'dccv']
, [528,9,528,10,'dccv']
, [531,9,531,10,'dccv']
, [533,13,533,14,'dccv']
, [534,17,534,46,'dccv']
, [535,17,535,65,'dccv']
, [536,17,536,39,'dccv']
, [537,17,537,38,'dccv']
, [538,17,538,89,'dccv']
, [539,13,539,14,'dccv']
, [544,9,544,10,'dccv']
, [547,9,547,10,'dccv']
, [549,13,549,14,'dccv']
, [550,17,550,46,'dccv']
, [551,17,551,74,'dccv']
, [552,17,552,39,'dccv']
, [553,17,553,38,'dccv']
, [554,17,554,89,'dccv']
, [555,13,555,14,'dccv']
, [560,9,560,10,'dccv']
, [563,9,563,10,'dccv']
, [565,13,565,14,'dccv']
, [566,17,566,81,'dccv']
, [567,17,567,18,'dccv']
, [568,21,568,72,'dccv']
, [569,21,569,66,'dccv']
, [570,21,570,66,'dccv']
, [571,21,571,63,'dccv']
, [572,21,572,51,'dccv']
, [573,17,573,18,'dccv']
, [574,13,574,14,'dccv']
, [579,9,579,10,'dccv']
, [586,9,586,10,'dccv']
, [587,13,587,44,'dccv']
, [588,9,588,10,'dccv']
, [592,9,592,10,'dccv']
, [593,13,593,96,'dccv']
, [594,13,594,78,'dccv']
, [595,9,595,10,'dccv']
, [598,9,598,10,'dccv']
, [599,13,599,41,'dccv']
, [600,13,600,113,'dccv']
, [601,9,601,10,'dccv']
, [609,9,609,10,'dccv']
, [611,13,611,14,'dccv']
, [612,17,612,52,'dccv']
, [613,17,613,18,'dccv']
, [614,21,614,28,'dccv']
, [614,57,614,78,'dccv']
, [614,30,614,53,'dccv']
, [615,21,615,22,'dccv']
, [616,25,616,53,'dccv']
, [617,21,617,22,'dccv']
, [614,54,614,56,'dccv']
, [619,21,619,51,'dccv']
, [620,17,620,18,'dccv']
, [622,17,622,52,'dccv']
, [623,17,623,18,'dccv']
, [624,21,624,28,'dccv']
, [624,61,624,82,'dccv']
, [624,30,624,57,'dccv']
, [625,21,625,22,'dccv']
, [626,25,626,57,'dccv']
, [627,21,627,22,'dccv']
, [624,58,624,60,'dccv']
, [629,21,629,51,'dccv']
, [630,17,630,18,'dccv']
, [632,17,632,67,'dccv']
, [633,17,633,18,'dccv']
, [634,21,634,97,'dccv']
, [635,21,635,22,'dccv']
, [636,25,636,90,'dccv']
, [637,25,637,61,'dccv']
, [638,21,638,22,'dccv']
, [640,21,640,93,'dccv']
, [641,21,641,22,'dccv']
, [642,25,642,82,'dccv']
, [643,25,643,49,'dccv']
, [644,21,644,22,'dccv']
, [645,17,645,18,'dccv']
, [647,17,647,41,'dccv']
, [648,13,648,14,'dccv']
, [653,9,653,10,'dccv']
, [659,9,659,10,'dccv']
, [660,13,660,43,'dccv']
, [661,9,661,10,'dccv']
, [667,9,667,10,'dccv']
, [669,13,669,14,'dccv']
, [670,13,670,14,'dccv']
, [674,9,674,10,'dccv']
, [680,9,680,10,'dccv']
, [682,13,682,14,'dccv']
, [683,13,683,14,'dccv']
, [687,9,687,10,'dccv']
, [32,9,32,26,'dcuc']
, [33,9,33,10,'dcuc']
, [35,13,35,14,'dcuc']
, [36,17,36,44,'dcuc']
, [37,13,37,14,'dcuc']
, [38,13,38,37,'dcuc']
, [39,13,39,14,'dcuc']
, [40,17,40,53,'dcuc']
, [41,13,41,14,'dcuc']
, [42,9,42,10,'dcuc']
, [106,13,106,37,'dcuc']
, [107,13,107,14,'dcuc']
, [108,17,108,53,'dcuc']
, [109,13,109,14,'dcuc']
, [122,13,122,14,'dcuc']
, [123,17,123,24,'dcuc']
, [135,13,135,37,'dcuc']
, [136,13,136,14,'dcuc']
, [137,17,137,53,'dcuc']
, [138,13,138,14,'dcuc']
, [147,9,147,10,'dcuc']
, [149,13,149,14,'dcuc']
, [150,13,150,14,'dcuc']
, [151,13,151,37,'dcuc']
, [152,13,152,14,'dcuc']
, [153,17,153,53,'dcuc']
, [154,13,154,14,'dcuc']
, [155,9,155,10,'dcuc']
, [163,9,163,10,'dcuc']
, [165,13,165,14,'dcuc']
, [166,13,166,14,'dcuc']
, [167,13,167,37,'dcuc']
, [168,13,168,14,'dcuc']
, [169,17,169,53,'dcuc']
, [170,13,170,14,'dcuc']
, [171,9,171,10,'dcuc']
, [178,9,178,10,'dcuc']
, [180,13,180,14,'dcuc']
, [181,13,181,14,'dcuc']
, [182,13,182,37,'dcuc']
, [183,13,183,14,'dcuc']
, [184,17,184,53,'dcuc']
, [185,13,185,14,'dcuc']
, [186,9,186,10,'dcuc']
, [194,9,194,10,'dcuc']
, [196,13,196,14,'dcuc']
, [197,17,197,36,'dcuc']
, [198,17,198,62,'dcuc']
, [199,13,199,14,'dcuc']
, [200,13,200,37,'dcuc']
, [201,13,201,14,'dcuc']
, [202,17,202,53,'dcuc']
, [203,13,203,14,'dcuc']
, [204,9,204,10,'dcuc']
, [215,13,215,37,'dcuc']
, [216,13,216,14,'dcuc']
, [217,17,217,53,'dcuc']
, [218,13,218,14,'dcuc']
, [245,13,245,37,'dcuc']
, [246,13,246,14,'dcuc']
, [247,17,247,53,'dcuc']
, [248,13,248,14,'dcuc']
, [265,17,265,18,'dcuc']
, [266,21,266,105,'dcuc']
, [267,17,267,18,'dcuc']
, [269,13,269,37,'dcuc']
, [270,13,270,14,'dcuc']
, [271,17,271,53,'dcuc']
, [272,13,272,14,'dcuc']
, [288,17,288,18,'dcuc']
, [289,21,289,105,'dcuc']
, [290,17,290,18,'dcuc']
, [292,13,292,37,'dcuc']
, [293,13,293,14,'dcuc']
, [294,17,294,53,'dcuc']
, [295,13,295,14,'dcuc']
, [322,13,322,37,'dcuc']
, [323,13,323,14,'dcuc']
, [324,17,324,53,'dcuc']
, [325,13,325,14,'dcuc']
, [350,13,350,37,'dcuc']
, [351,13,351,14,'dcuc']
, [352,17,352,53,'dcuc']
, [353,13,353,14,'dcuc']
, [367,17,367,18,'dcuc']
, [368,21,368,41,'dcuc']
, [369,17,369,18,'dcuc']
, [371,13,371,37,'dcuc']
, [372,13,372,14,'dcuc']
, [373,17,373,53,'dcuc']
, [374,13,374,14,'dcuc']
, [379,9,379,10,'dcuc']
, [380,13,380,33,'dcuc']
, [381,13,381,47,'dcuc']
, [382,9,382,10,'dcuc']
, [386,9,386,10,'dcuc']
, [387,13,387,33,'dcuc']
, [388,13,388,47,'dcuc']
, [389,9,389,10,'dcuc']
, [399,13,399,37,'dcuc']
, [400,13,400,14,'dcuc']
, [401,17,401,53,'dcuc']
, [402,13,402,14,'dcuc']
, [413,17,413,18,'dcuc']
, [414,21,414,41,'dcuc']
, [415,17,415,18,'dcuc']
, [417,17,417,18,'dcuc']
, [418,21,418,41,'dcuc']
, [419,17,419,18,'dcuc']
, [421,13,421,37,'dcuc']
, [422,13,422,14,'dcuc']
, [423,17,423,53,'dcuc']
, [424,13,424,14,'dcuc']
, [442,13,442,37,'dcuc']
, [443,13,443,14,'dcuc']
, [444,17,444,53,'dcuc']
, [445,13,445,14,'dcuc']
, [460,21,460,22,'dcuc']
, [461,25,461,35,'dcuc']
, [462,21,462,22,'dcuc']
, [467,13,467,37,'dcuc']
, [468,13,468,14,'dcuc']
, [469,17,469,53,'dcuc']
, [470,13,470,14,'dcuc']
, [485,21,485,22,'dcuc']
, [486,25,486,35,'dcuc']
, [487,21,487,22,'dcuc']
, [492,13,492,37,'dcuc']
, [493,13,493,14,'dcuc']
, [494,17,494,53,'dcuc']
, [495,13,495,14,'dcuc']
, [509,13,509,37,'dcuc']
, [510,13,510,14,'dcuc']
, [511,17,511,53,'dcuc']
, [512,13,512,14,'dcuc']
, [524,13,524,37,'dcuc']
, [525,13,525,14,'dcuc']
, [526,17,526,53,'dcuc']
, [527,13,527,14,'dcuc']
, [540,13,540,37,'dcuc']
, [541,13,541,14,'dcuc']
, [542,17,542,53,'dcuc']
, [543,13,543,14,'dcuc']
, [556,13,556,37,'dcuc']
, [557,13,557,14,'dcuc']
, [558,17,558,53,'dcuc']
, [559,13,559,14,'dcuc']
, [575,13,575,37,'dcuc']
, [576,13,576,14,'dcuc']
, [577,17,577,53,'dcuc']
, [578,13,578,14,'dcuc']
, [649,13,649,37,'dcuc']
, [650,13,650,14,'dcuc']
, [651,17,651,53,'dcuc']
, [652,13,652,14,'dcuc']
, [671,13,671,31,'dcuc']
, [672,13,672,14,'dcuc']
, [673,13,673,14,'dcuc']
, [684,13,684,31,'dcuc']
, [685,13,685,14,'dcuc']
, [686,13,686,14,'dcuc']
];
		</script><link rel="stylesheet" type="text/css" href="../css/coverreport.css" />
	</head><body>
		<code id="src273" class="dotCoverSource"><pre>#region

using System;
using System.Reflection;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;
using LGP.Components.Factory;
using LGP.Components.Factory.Interfaces.Database;
using LGP.Components.Factory.Interfaces.Module;
using LGP.Modules.OrganizationUnitExplorer.Internal;
using LGP.Modules.OrganizationUnitExplorer.Internal.CustomControls;
using LGP.Modules.OrganizationUnitExplorer.Internal.Modals.Controls;
using LGP.Modules.OrganizationUnitExplorer.Internal.NodeViews;

#endregion

namespace LGP.Modules.OrganizationUnitExplorer
{
    /// &lt;summary&gt;
    ///   Interaction logic for OuViewer.xaml
    /// &lt;/summary&gt;
    public partial class OuViewer : IOuObserver , IUserControl
    {
        private IOu _ou;
        private int _viewType1;
        private int _viewType2;

        /// &lt;summary&gt;
        ///   Constructor
        /// &lt;/summary&gt;
        public OuViewer()
        {
            try
            {
                this.InitializeComponent();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Constructor
        /// &lt;/summary&gt;
        public OuViewer( IOu ou )
        {
            try
            {
                this.InitializeComponent();

                OuHelper.ClientGateway.Refresh();

                ou.Attach( this );

                this.Name = ou.GetName();
                this.Tag = ou.GetName();
                this._ou = ou;

                this._viewType1 = 1;
                this._viewType2 = 1;

                this.GridViewImage1.Source = Framework.Images.GetImage( &quot;graphic-design&quot; , &quot;16x16&quot; , 12 ).Source;
                this.ListViewImage1.Source = Framework.Images.GetImage( &quot;attibutes&quot; , &quot;16x16&quot; , 12 ).Source;
                this.GridViewImage2.Source = Framework.Images.GetImage( &quot;graphic-design&quot; , &quot;16x16&quot; , 12 ).Source;
                this.ListViewImage2.Source = Framework.Images.GetImage( &quot;attibutes&quot; , &quot;16x16&quot; , 12 ).Source;
                this.ImageMinusZoom.Source = Framework.Images.GetImage( &quot;zoomout&quot; , &quot;VS2010ImageLibrary&quot; , 12 ).Source;
                this.ImagePlusZoom.Source = Framework.Images.GetImage( &quot;zoomin&quot; , &quot;VS2010ImageLibrary&quot; , 12 ).Source;
                this.OuImage.Source = this._ou.GetOuImage( 16 ).Source;

                var resource = Framework.Utils.LoadResource( Assembly.GetExecutingAssembly() , &quot;LGP.Modules.OrganizationUnitExplorer.Internal.ContextMenuItems.OuContextMenu.xaml&quot; );

                var menu = resource as ContextMenu;
                if( menu != null )
                {
                    var item = ( MenuItem ) menu.Items[ 0 ];
                    item.Click += this.AddMenuItemClick;
                    item.Icon = Framework.Images.GetImage( &quot;workgroup&quot; , &quot;distros/32&quot; , 12 );
                    menu.Items.Remove( item );
                    this.OuImageMenu.Items.Add( item );

                    item = ( MenuItem ) menu.Items[ 0 ];
                    item.Click += this.RenameMenuItemClick;
                    item.Icon = Framework.Images.GetImage( &quot;RenameFolderHS&quot; , &quot;VS2010ImageLibrary&quot; , 12 );
                    menu.Items.Remove( item );
                    this.OuImageMenu.Items.Add( item );

                    item = ( MenuItem ) menu.Items[ 0 ];
                    item.Click += this.MoveMenuItemClick;
                    item.Icon = Framework.Images.GetImage( &quot;Move&quot; , &quot;VS2010ImageLibrary&quot; , 12 );
                    menu.Items.Remove( item );
                    this.OuImageMenu.Items.Add( item );

                    item = ( MenuItem ) menu.Items[ 0 ];
                    item.Click += this.DeleteMenuItemClick;
                    item.Icon = Framework.Images.GetImage( &quot;DeleteHS&quot; , &quot;VS2010ImageLibrary&quot; , 12 );
                    menu.Items.Remove( item );
                    this.OuImageMenu.Items.Add( item );
                }

                this.OuLabel.Content = this._ou.GetName();
                this.ShowOrganizationalUnit( 64 );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        #region IOuObserver Members

        /// &lt;summary&gt;
        ///   Update this observer with a refernece to the ou
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;ou&quot;&gt;Iou&lt;/param&gt;
        /// &lt;param name = &quot;source&quot;&gt;source observer&lt;/param&gt;
        public void Update( IOu ou , IOuObserver source )
        {
            if( this == source )
            {
                return;
            }

            try
            {
                this._ou = ou;
                this.Name = this._ou.GetName();
                this.OuLabel.Content = this._ou.GetName();
                this.Tag = this._ou.GetName();
                Framework.Panels.UpdateTabNames();
                this.ShowOrganizationalUnit( ( ( int ) this.progressBar1.Value ) + 32 );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Attach objewcts that observer this IOu
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IOuObserver&lt;/param&gt;
        public void Attach( IOuObserver obj )
        {
            try
            {
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Detach objewcts that observer this IOu
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IOuObserver&lt;/param&gt;
        public void Detach( IOuObserver obj )
        {
            try
            {
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Notify observers of this IOu
        /// &lt;/summary&gt;
        public void Notify()
        {
            try
            {
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Dispose this object and all the observers
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IOuObserver&lt;/param&gt;
        public void Dispose( IOuObserver obj )
        {
            try
            {
                obj.Detach( this );
                Framework.Panels.RemoveMainComponent( this );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        #endregion

        private void MenuItemClick( object sender , RoutedEventArgs e )
        {
            try
            {
                var menuitem = sender as MenuItem;
                Framework.ContextMenus.CallBack( menuitem , this._ou );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void ShowOrganizationalUnit( int size )
        {
            try
            {
                if( this.viewer1.Children != null )
                {
                    foreach( WrapPanelOuElement item in this.viewer1.Children )
                    {
                        item.GetOu().Detach( item );
                    }

                    this.viewer1.Children.Clear();
                }

                if( this.viewer2.Children != null )
                {
                    foreach( WrapPanelClientElement item in this.viewer2.Children )
                    {
                        item.GetClient().Detach( item );
                    }

                    this.viewer2.Children.Clear();
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }

            try
            {
                var ous = OuHelper.OuGateway.GetChildren( this._ou.GetOuId() );

                if( ous != null )
                {
                    for( var y = 0; y &lt; ous.Count; y++ )
                    {
                        var ele = new WrapPanelOuElement( ous[ y ] , size , this );
                        this.viewer1.Children.Add( ele );
                    }

                    this.mainGrid.RowDefinitions[ 2 ].Height = new GridLength( 140 , GridUnitType.Star );
                }
                else
                {
                    this.mainGrid.RowDefinitions[ 2 ].Height = new GridLength( 22 , GridUnitType.Star );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }

            try
            {
                var clients = OuHelper.ClientGateway.GetOuClients( this._ou.GetOuId() );

                if( clients != null )
                {
                    for( var y = 0; y &lt; clients.Count; y++ )
                    {
                        var ele = new WrapPanelClientElement( clients[ y ] , size , this );
                        this.viewer2.Children.Add( ele );
                    }
                    this.mainGrid.RowDefinitions[ 4 ].Height = new GridLength( 140 , GridUnitType.Star );
                }
                else
                {
                    this.mainGrid.RowDefinitions[ 4 ].Height = new GridLength( 22 , GridUnitType.Star );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;pane&quot;&gt;&lt;/param&gt;
        public void SetDetailsPane( UserControl pane )
        {
            try
            {
                if( this.ClientViewBorderContainer.Child != null )
                {
                    if( this.ClientViewBorderContainer.Child.GetType() == typeof( ClientPane ) )
                    {
                        var client = ( ClientPane ) this.ClientViewBorderContainer.Child;
                        client.GetClient().Detach( client );
                    }

                    if( this.ClientViewBorderContainer.Child.GetType() == typeof( OuPane ) )
                    {
                        var ou = ( OuPane ) this.ClientViewBorderContainer.Child;
                        ou.GetOu().Detach( ou );
                    }
                }
                this.ClientViewBorderContainer.Child = pane;
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void GridViewImageMouseDown1( object sender , MouseButtonEventArgs e )
        {
            this._viewType1 = 1;
            this.ListViewImage1.Opacity = 0.2;
        }


        private void ListViewImageMouseDown1( object sender , MouseButtonEventArgs e )
        {
            this._viewType1 = 0;
            this.GridViewImage1.Opacity = 0.2;
        }


        private void ImageMouseEnter1( object sender , MouseEventArgs e )
        {
            try
            {
                var image = ( Image ) sender;
                image.Opacity = 0.8;
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void ImageMouseLeave1( object sender , MouseEventArgs e )
        {
            try
            {
                var image = ( Image ) sender;

                if( this._viewType1 == 1 &amp;&amp; image.Tag.ToString().CompareTo( &quot;ListView&quot; ) == 0 )
                {
                    image.Opacity = 0.2;
                }
                else if( this._viewType1 == 0 &amp;&amp; image.Tag.ToString().CompareTo( &quot;GridView&quot; ) == 0 )
                {
                    image.Opacity = 0.2;
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void GridViewImageMouseDown2( object sender , MouseButtonEventArgs e )
        {
            this._viewType2 = 1;
            this.ListViewImage2.Opacity = 0.2;
        }


        private void ListViewImageMouseDown2( object sender , MouseButtonEventArgs e )
        {
            this._viewType2 = 0;
            this.GridViewImage2.Opacity = 0.2;
        }


        private void ImageMouseEnter2( object sender , MouseEventArgs e )
        {
            try
            {
                var image = ( Image ) sender;
                image.Opacity = 0.8;
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void ImageMouseLeave2( object sender , MouseEventArgs e )
        {
            try
            {
                var image = ( Image ) sender;

                if( this._viewType2 == 1 &amp;&amp; image.Tag.ToString().CompareTo( &quot;ListView&quot; ) == 0 )
                {
                    image.Opacity = 0.2;
                }
                else if( this._viewType2 == 0 &amp;&amp; image.Tag.ToString().CompareTo( &quot;GridView&quot; ) == 0 )
                {
                    image.Opacity = 0.2;
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void ResizeOrganizationalUnits( int pos )
        {
            try
            {
                foreach( UIElement ele in this.viewer1.Children )
                {
                    ( ( WrapPanelOuElement ) ele ).Resize( pos );
                }

                foreach( UIElement ele in this.viewer2.Children )
                {
                    ( ( WrapPanelClientElement ) ele ).Resize( pos );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void ProgressBar1MouseMove( object sender , MouseEventArgs e )
        {
            try
            {
                if( e.LeftButton == MouseButtonState.Pressed )
                {
                    var pos = ( ( decimal ) e.GetPosition( this.progressBar1 ).X / ( decimal ) this.progressBar1.Width ) * 100;
                    this.progressBar1.Value = Convert.ToInt32( pos );
                    pos = Convert.ToInt32( pos ) + 32;

                    if( pos &gt; 128 )
                    {
                        pos = 128;
                    }

                    this.ResizeOrganizationalUnits( ( int ) pos );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void ProgressBar1MouseLeftButtonDown( object sender , MouseButtonEventArgs e )
        {
            try
            {
                if( e.LeftButton == MouseButtonState.Pressed )
                {
                    var pos = ( ( decimal ) e.GetPosition( this.progressBar1 ).X / ( decimal ) this.progressBar1.Width ) * 100;
                    this.progressBar1.Value = Convert.ToInt32( pos );
                    pos = Convert.ToInt32( pos ) + 32;

                    if( pos &gt; 128 )
                    {
                        pos = 128;
                    }

                    this.ResizeOrganizationalUnits( ( int ) pos );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void AddMenuItemClick( object sender , RoutedEventArgs e )
        {
            try
            {
                var popup = Framework.Dialog;
                var cou = new CreateOu( this , this._ou , popup );
                popup.SetChild( cou );
                popup.ShowBlocking();
                this.ShowOrganizationalUnit( ( ( int ) this.progressBar1.Value ) + 32 );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void RenameMenuItemClick( object sender , RoutedEventArgs e )
        {
            try
            {
                this.OuLabelEditBox.Text = this.OuLabel.Content.ToString();
                this.OuLabel.Visibility = Visibility.Hidden;
                this.OuLabelEditBox.Visibility = Visibility.Visible;
                this.ShowOrganizationalUnit( ( ( int ) this.progressBar1.Value ) + 32 );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void MoveMenuItemClick( object sender , RoutedEventArgs e )
        {
            try
            {
                var popup = Framework.Dialog;
                var cou = new MoveOu( this , this._ou , popup );
                popup.SetChild( cou );
                popup.ShowBlocking();
                this.ShowOrganizationalUnit( ( ( int ) this.progressBar1.Value ) + 32 );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void DeleteMenuItemClick( object sender , RoutedEventArgs e )
        {
            try
            {
                var popup = Framework.Dialog;
                var cou = new DeleteOu( this , this._ou , popup , true );
                popup.SetChild( cou );
                popup.ShowBlocking();
                this.ShowOrganizationalUnit( ( ( int ) this.progressBar1.Value ) + 32 );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void OuEditBoxKeyUp( object sender , KeyEventArgs e )
        {
            try
            {
                if( e.Key == Key.Return &amp;&amp; this.OuLabelEditBox.Text.Length &gt; 0 )
                {
                    this.OuLabelEditBox.Visibility = Visibility.Hidden;
                    this.OuLabel.Visibility = Visibility.Visible;
                    this._ou.SetName( this.OuLabelEditBox.Text );
                    this.OuLabel.Content = this._ou.GetName();
                    this.Tag = this._ou.GetName();
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        /// &lt;summary&gt;
        ///   Used bu children to request update
        /// &lt;/summary&gt;
        public void Update()
        {
            this.Update( this._ou , null );
        }


        private void OuLabelEditBoxTextChanged( object sender , TextChangedEventArgs e )
        {
            this.OuLabelEditBox.Text = Framework.Utils.CleanString( this.OuLabelEditBox.Text );
            this.OuLabelEditBox.CaretIndex = this.OuLabelEditBox.Text.Length;
        }

        private void OuImageMenuSubmenuOpened( object sender , RoutedEventArgs e )
        {
            var menu = this.OuImageMenu;
            Framework.ContextMenus.AttachMenuItemRegistrations( ref menu , typeof( IOu ) , this.MenuItemClick );
        }

        #region Implementation of IUserControl

        /// &lt;summary&gt;
        ///   Aks the UserControl to do some clean up!
        /// &lt;/summary&gt;
        public void Dispose()
        {
            try
            {
                if( this.viewer1.Children != null )
                {
                    foreach( WrapPanelOuElement item in this.viewer1.Children )
                    {
                        item.GetOu().Detach( item );
                    }

                    this.viewer1.Children.Clear();
                }

                if( this.viewer2.Children != null )
                {
                    foreach( WrapPanelClientElement item in this.viewer2.Children )
                    {
                        item.GetClient().Detach( item );
                    }

                    this.viewer2.Children.Clear();
                }

                if( this.ClientViewBorderContainer.Child != null )
                {
                    if( this.ClientViewBorderContainer.Child.GetType() == typeof( ClientPane ) )
                    {
                        var client = ( ClientPane ) this.ClientViewBorderContainer.Child;
                        client.GetClient().Detach( client );
                    }

                    if( this.ClientViewBorderContainer.Child.GetType() == typeof( OuPane ) )
                    {
                        var ou = ( OuPane ) this.ClientViewBorderContainer.Child;
                        ou.GetOu().Detach( ou );
                    }
                }

                this._ou.Detach( this );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        /// Asks the Usercontrol to refresh itself
        /// &lt;/summary&gt;
        public void Refresh()
        {
            this.Tag = this._ou.GetName();
        }

        /// &lt;summary&gt;
        /// When the control is no longer in focus, asks it to pause ( heavy duty non critical, ie threads updating graphs )
        /// &lt;/summary&gt;
        public void Pause()
        {
            try
            {
            }
            catch( Exception )
            {
            }
        }

        /// &lt;summary&gt;
        /// When the tab comes back into focus, resume ( heavy duty non critical, ie threads updating graphs )
        /// &lt;/summary&gt;
        public void Resume()
        {
            try
            {
            }
            catch( Exception )
            {
            }
        }

        #endregion
    }
}</pre></code><script type="text/javascript">
			applyranges('src273', RANGES_273)
		</script>
	</body>
</html>