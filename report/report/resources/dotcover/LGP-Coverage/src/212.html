<html>
	<head>
		<script type="text/javascript" src="../js/coverreport.js">

		</script><script type="text/javascript">
			RANGES_212 = [
   [56,9,56,10,'dccv']
, [58,13,58,14,'dccv']
, [59,17,59,39,'dccv']
, [60,17,60,39,'dccv']
, [61,17,61,39,'dccv']
, [62,17,62,39,'dccv']
, [63,17,63,41,'dccv']
, [64,17,64,39,'dccv']
, [66,17,66,24,'dccv']
, [66,49,66,86,'dccv']
, [66,26,66,45,'dccv']
, [67,17,67,18,'dccv']
, [68,21,68,65,'dccv']
, [69,17,69,18,'dccv']
, [66,46,66,48,'dccv']
, [71,17,71,24,'dccv']
, [71,43,71,83,'dccv']
, [71,40,71,42,'dccv']
, [75,13,75,14,'dccv']
, [80,9,80,10,'dccv']
, [213,9,213,10,'dccv']
, [214,13,214,33,'dccv']
, [217,13,217,14,'dccv']
, [218,17,218,79,'dccv']
, [219,17,219,80,'dccv']
, [220,17,220,54,'dccv']
, [221,13,221,14,'dccv']
, [228,9,228,10,'dccv']
, [28,9,28,10,'dcuc']
, [29,13,29,46,'dcuc']
, [30,9,30,10,'dcuc']
, [38,9,38,10,'dcuc']
, [39,13,39,67,'dcuc']
, [40,9,40,10,'dcuc']
, [48,9,48,10,'dcuc']
, [49,9,49,10,'dcuc']
, [71,26,71,39,'dcuc']
, [72,17,72,18,'dcuc']
, [73,21,73,59,'dcuc']
, [74,17,74,18,'dcuc']
, [76,13,76,37,'dcuc']
, [77,13,77,14,'dcuc']
, [78,17,78,53,'dcuc']
, [79,13,79,14,'dcuc']
, [90,9,90,10,'dcuc']
, [91,13,94,15,'dcuc']
, [96,13,96,29,'dcuc']
, [97,9,97,10,'dcuc']
, [107,9,107,10,'dcuc']
, [108,13,111,15,'dcuc']
, [113,13,113,29,'dcuc']
, [114,9,114,10,'dcuc']
, [123,9,123,10,'dcuc']
, [124,13,124,33,'dcuc']
, [127,13,127,14,'dcuc']
, [128,17,128,50,'dcuc']
, [129,13,129,14,'dcuc']
, [130,13,130,37,'dcuc']
, [131,13,131,14,'dcuc']
, [132,17,132,53,'dcuc']
, [133,17,133,36,'dcuc']
, [134,17,134,48,'dcuc']
, [135,13,135,14,'dcuc']
, [136,9,136,10,'dcuc']
, [144,9,144,10,'dcuc']
, [145,13,145,33,'dcuc']
, [148,13,148,14,'dcuc']
, [149,17,149,60,'dcuc']
, [150,13,150,14,'dcuc']
, [151,13,151,37,'dcuc']
, [152,13,152,14,'dcuc']
, [153,17,153,53,'dcuc']
, [154,17,154,36,'dcuc']
, [155,17,155,48,'dcuc']
, [156,13,156,14,'dcuc']
, [157,9,157,10,'dcuc']
, [166,9,166,10,'dcuc']
, [167,13,167,33,'dcuc']
, [170,13,170,14,'dcuc']
, [171,17,171,79,'dcuc']
, [172,17,172,47,'dcuc']
, [173,13,173,14,'dcuc']
, [174,13,174,37,'dcuc']
, [175,13,175,14,'dcuc']
, [176,17,176,53,'dcuc']
, [177,17,177,36,'dcuc']
, [178,17,178,48,'dcuc']
, [179,13,179,14,'dcuc']
, [180,9,180,10,'dcuc']
, [189,9,189,10,'dcuc']
, [190,13,190,33,'dcuc']
, [193,13,193,14,'dcuc']
, [194,17,194,79,'dcuc']
, [195,17,195,52,'dcuc']
, [196,13,196,14,'dcuc']
, [197,13,197,37,'dcuc']
, [198,13,198,14,'dcuc']
, [199,17,199,53,'dcuc']
, [200,17,200,36,'dcuc']
, [201,17,201,48,'dcuc']
, [202,13,202,14,'dcuc']
, [203,9,203,10,'dcuc']
, [222,13,222,37,'dcuc']
, [223,13,223,14,'dcuc']
, [224,17,224,53,'dcuc']
, [225,17,225,36,'dcuc']
, [226,17,226,48,'dcuc']
, [227,13,227,14,'dcuc']
, [238,9,238,10,'dcuc']
, [239,13,239,33,'dcuc']
, [242,13,242,14,'dcuc']
, [243,17,243,79,'dcuc']
, [244,17,244,80,'dcuc']
, [245,17,245,64,'dcuc']
, [246,13,246,14,'dcuc']
, [247,13,247,37,'dcuc']
, [248,13,248,14,'dcuc']
, [249,17,249,53,'dcuc']
, [250,17,250,36,'dcuc']
, [251,17,251,48,'dcuc']
, [252,13,252,14,'dcuc']
, [253,9,253,10,'dcuc']
, [261,9,261,10,'dcuc']
, [262,13,262,32,'dcuc']
, [263,9,263,10,'dcuc']
, [271,9,271,10,'dcuc']
, [272,13,272,35,'dcuc']
, [273,9,273,10,'dcuc']
];
		</script><link rel="stylesheet" type="text/css" href="../css/coverreport.css" />
	</head><body>
		<code id="src212" class="dotCoverSource"><pre>#region

using System;
using System.Windows.Controls;
using LGP.Components.Factory;
using LGP.Components.Factory.Interfaces.Component;

#endregion

namespace LGP.Components.Menus
{
    /// &lt;summary&gt;
    ///   Concreate Implementation of the IMenu
    /// &lt;/summary&gt;
    public partial class MenuHandler : IMenu
    {
        private bool _error;
        private Menu _mainMenu;
        private string _strerror;

        #region IMenu Members

        /// &lt;summary&gt;
        ///   Gets the components name
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public string GetName()
        {
            return Properties.Resources.Menu;
        }


        /// &lt;summary&gt;
        ///   Gets the icon associated with this component
        /// &lt;/summary&gt;
        /// &lt;returns&gt;Image&lt;/returns&gt;
        public Image GetIcon()
        {
            return Framework.Images.GetImage( &quot;lgp&quot; , &quot;128x128&quot; );
        }


        /// &lt;summary&gt;
        ///   Registers this components menu handlers
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;menu&quot;&gt;The program main menu&lt;/param&gt;
        public void RegisterMenuEntries( IMenu menu )
        {
        }

        /// &lt;summary&gt;
        ///   Creates an instance of the menu controller and passes the appication menu reference to it
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;menu&quot;&gt;The application menu&lt;/param&gt;
        public void InitializeMenu( System.Windows.Controls.Menu menu )
        {
            try
            {
                this._mainMenu = menu;
                this.CreateFileMenu();
                this.CreateEditMenu();
                this.CreateViewMenu();
                this.CreateWindowMenu();
                this.CreateHelpMenu();

                foreach( var moduleComponent in Framework.LibraryHandler.GetModules() )
                {
                    moduleComponent.RegisterMenuEntries( this );
                }

                foreach( var component in Framework.LibraryHandler.GetComponents() )
                {
                    component.RegisterMenuEntries( this );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        #endregion

        /// &lt;summary&gt;
        ///   Creates a menu item
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;header&quot;&gt;Name of the menu item&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public MenuItem CreateMenuItem( string header )
        {
            var menuitem = new MenuItem
            {
                Header = header
            };

            return menuitem;
        }


        /// &lt;summary&gt;
        ///   Creates a menu item with an image
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;header&quot;&gt;Name of the menu item&lt;/param&gt;
        /// &lt;param name = &quot;image&quot;&gt;Image assocaited with the menu item&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public MenuItem CreateMenuItem( string header , Image image )
        {
            var menuitem = new MenuItem
            {
                Header = header , Icon = image
            };

            return menuitem;
        }

        #region IMenu Interface Realization

        /// &lt;summary&gt;
        ///   Adds a item to the main menu
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;item&quot;&gt;The item to be added&lt;/param&gt;
        public void AddMainItem( MenuItem item )
        {
            this._error = false;

            try
            {
                this._mainMenu.Items.Add( item );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
                this._error = true;
                this._strerror = error.Message;
            }
        }


        /// &lt;summary&gt;
        ///   Remove an item from the menu at given index
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;indexItem&quot;&gt;The index item to remove&lt;/param&gt;
        public void RemoveMainMenuItem( int indexItem )
        {
            this._error = false;

            try
            {
                this._mainMenu.Items.RemoveAt( indexItem );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
                this._error = true;
                this._strerror = error.Message;
            }
        }


        /// &lt;summary&gt;
        ///   Add an item under a given item specified by index
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;indexItem&quot;&gt;&lt;/param&gt;
        /// &lt;param name = &quot;subitem&quot;&gt;&lt;/param&gt;
        public void AddSubMenuItem( int indexItem , MenuItem subitem )
        {
            this._error = false;

            try
            {
                var menuitem = ( MenuItem ) this._mainMenu.Items[ indexItem ];
                menuitem.Items.Add( subitem );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
                this._error = true;
                this._strerror = error.Message;
            }
        }


        /// &lt;summary&gt;
        ///   Remove an index given two indexes Item / subitem
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;indexItem&quot;&gt;The main item index&lt;/param&gt;
        /// &lt;param name = &quot;subitem&quot;&gt;The sub item index&lt;/param&gt;
        public void RemoveSubMenuItem( int indexItem , int subitem )
        {
            this._error = false;

            try
            {
                var menuitem = ( MenuItem ) this._mainMenu.Items[ indexItem ];
                menuitem.Items.RemoveAt( subitem );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
                this._error = true;
                this._strerror = error.Message;
            }
        }


        /// &lt;summary&gt;
        ///   Add a subitem to a subitem item, item / subitem specified by indexes
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;indexItem&quot;&gt;The item index&lt;/param&gt;
        /// &lt;param name = &quot;indexSubItem&quot;&gt;The sub item index&lt;/param&gt;
        /// &lt;param name = &quot;subsubitem&quot;&gt;The new item to add to the sub item&lt;/param&gt;
        public void AddSubSubMenuItem( int indexItem , int indexSubItem , MenuItem subsubitem )
        {
            this._error = false;

            try
            {
                var menuitem = ( MenuItem ) this._mainMenu.Items[ indexItem ];
                var menusubitems = ( MenuItem ) menuitem.Items[ indexSubItem ];
                menusubitems.Items.Add( subsubitem );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
                this._error = true;
                this._strerror = error.Message;
            }
        }


        /// &lt;summary&gt;
        ///   Remove a indexed subitem , given an item index and its sub item index
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;indexItem&quot;&gt;The item index&lt;/param&gt;
        /// &lt;param name = &quot;indexSubItem&quot;&gt;The sub item index&lt;/param&gt;
        /// &lt;param name = &quot;indexSubSubItem&quot;&gt;The item index to remove&lt;/param&gt;
        public void RemoveSubMenuItem( int indexItem , int indexSubItem , int indexSubSubItem )
        {
            this._error = false;

            try
            {
                var menuitem = ( MenuItem ) this._mainMenu.Items[ indexItem ];
                var menusubitems = ( MenuItem ) menuitem.Items[ indexSubItem ];
                menusubitems.Items.RemoveAt( indexSubSubItem );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
                this._error = true;
                this._strerror = error.Message;
            }
        }


        /// &lt;summary&gt;
        ///   Used as an accessor to check if there was an operation error
        /// &lt;/summary&gt;
        /// &lt;returns&gt;True or false if an error occured&lt;/returns&gt;
        public bool GetError()
        {
            return this._error;
        }


        /// &lt;summary&gt;
        ///   Gets the error from the last operation that caused it
        /// &lt;/summary&gt;
        /// &lt;returns&gt;The error describing the error&lt;/returns&gt;
        public string GetStrError()
        {
            return this._strerror;
        }

        #endregion
    }
}</pre></code><script type="text/javascript">
			applyranges('src212', RANGES_212)
		</script>
	</body>
</html>