<html>
	<head>
		<script type="text/javascript" src="../js/coverreport.js">

		</script><script type="text/javascript">
			RANGES_250 = [
   [34,9,34,46,'dccv']
, [35,9,35,10,'dccv']
, [37,13,37,14,'dccv']
, [38,17,38,44,'dccv']
, [39,17,39,39,'dccv']
, [40,17,40,45,'dccv']
, [41,17,41,121,'dccv']
, [42,17,42,32,'dccv']
, [44,17,47,19,'dccv']
, [48,17,48,66,'dccv']
, [49,17,49,48,'dccv']
, [51,17,51,111,'dccv']
, [52,17,52,65,'dccv']
, [54,17,54,54,'dccv']
, [55,13,55,14,'dccv']
, [60,9,60,10,'dccv']
, [63,9,63,10,'dccv']
, [65,13,65,14,'dccv']
, [66,17,66,32,'dccv']
, [67,13,67,14,'dccv']
, [71,9,71,10,'dccv']
, [74,9,74,10,'dccv']
, [76,13,76,14,'dccv']
, [77,17,77,43,'dccv']
, [82,17,82,80,'dccv']
, [83,17,83,18,'dccv']
, [84,21,84,54,'dccv']
, [85,21,85,51,'dccv']
, [86,17,86,18,'dccv']
, [88,17,88,18,'dccv']
, [89,21,89,55,'dccv']
, [90,21,90,51,'dccv']
, [91,17,91,18,'dccv']
, [92,13,92,14,'dccv']
, [97,9,97,10,'dccv']
, [100,9,100,10,'dccv']
, [102,13,102,14,'dccv']
, [103,17,103,77,'dccv']
, [104,13,104,14,'dccv']
, [109,9,109,10,'dccv']
, [159,9,159,10,'dccv']
, [161,13,161,14,'dccv']
, [162,17,162,51,'dccv']
, [164,17,164,67,'dccv']
, [165,17,165,76,'dccv']
, [166,17,166,76,'dccv']
, [168,17,168,70,'dccv']
, [169,17,169,18,'dccv']
, [170,21,170,97,'dccv']
, [171,21,171,35,'dccv']
, [172,21,172,22,'dccv']
, [173,25,173,113,'dccv']
, [174,25,174,113,'dccv']
, [175,21,175,22,'dccv']
, [177,21,177,22,'dccv']
, [178,25,178,105,'dccv']
, [179,25,179,87,'dccv']
, [180,21,180,22,'dccv']
, [181,17,181,18,'dccv']
, [187,13,187,14,'dccv']
, [192,9,192,10,'dccv']
, [196,9,196,10,'dccv']
, [198,13,198,14,'dccv']
, [199,17,199,131,'dccv']
, [200,17,200,107,'dccv']
, [201,17,201,105,'dccv']
, [202,17,202,111,'dccv']
, [203,17,203,109,'dccv']
, [204,17,204,107,'dccv']
, [205,17,205,107,'dccv']
, [206,17,206,107,'dccv']
, [207,17,207,111,'dccv']
, [208,17,208,102,'dccv']
, [209,17,209,112,'dccv']
, [210,17,210,118,'dccv']
, [211,13,211,14,'dccv']
, [216,9,216,10,'dccv']
, [219,9,219,10,'dccv']
, [221,13,221,14,'dccv']
, [222,17,222,88,'dccv']
, [223,17,223,69,'dccv']
, [224,17,224,73,'dccv']
, [225,13,225,14,'dccv']
, [230,9,230,10,'dccv']
, [233,9,233,10,'dccv']
, [235,13,235,14,'dccv']
, [236,17,236,46,'dccv']
, [237,17,237,75,'dccv']
, [238,17,238,39,'dccv']
, [239,17,239,38,'dccv']
, [240,13,240,14,'dccv']
, [245,9,245,10,'dccv']
, [248,9,248,10,'dccv']
, [250,13,250,14,'dccv']
, [251,17,251,108,'dccv']
, [252,17,252,90,'dccv']
, [253,13,253,14,'dccv']
, [258,9,258,10,'dccv']
, [261,9,261,10,'dccv']
, [263,13,263,14,'dccv']
, [264,17,264,85,'dccv']
, [265,17,265,18,'dccv']
, [266,21,266,76,'dccv']
, [267,21,267,74,'dccv']
, [268,21,268,80,'dccv']
, [269,21,269,81,'dccv']
, [270,17,270,18,'dccv']
, [271,13,271,14,'dccv']
, [276,9,276,10,'dccv']
, [279,9,279,10,'dccv']
, [281,13,281,14,'dccv']
, [282,17,282,81,'dccv']
, [283,13,283,14,'dccv']
, [288,9,288,10,'dccv']
, [291,9,291,10,'dccv']
, [293,13,293,14,'dccv']
, [294,17,294,49,'dccv']
, [295,17,295,38,'dccv']
, [296,17,296,18,'dccv']
, [297,21,297,114,'dccv']
, [298,21,298,47,'dccv']
, [299,21,299,22,'dccv']
, [300,25,300,72,'dccv']
, [301,21,301,22,'dccv']
, [302,17,302,18,'dccv']
, [303,13,303,14,'dccv']
, [308,9,308,10,'dccv']
, [316,9,316,10,'dccv']
, [318,13,318,14,'dccv']
, [319,17,319,55,'dccv']
, [320,17,320,45,'dccv']
, [321,17,321,47,'dccv']
, [322,17,322,37,'dccv']
, [324,17,324,80,'dccv']
, [325,17,325,38,'dccv']
, [326,13,326,14,'dccv']
, [327,13,327,31,'dccv']
, [328,13,328,14,'dccv']
, [329,13,329,14,'dccv']
, [330,9,330,10,'dccv']
, [336,9,336,10,'dccv']
, [337,13,337,61,'dccv']
, [338,9,338,10,'dccv']
, [344,9,344,10,'dccv']
, [346,13,346,14,'dccv']
, [347,13,347,14,'dccv']
, [351,9,351,10,'dccv']
, [357,9,357,10,'dccv']
, [359,13,359,14,'dccv']
, [360,13,360,14,'dccv']
, [364,9,364,10,'dccv']
, [376,9,376,10,'dccv']
, [378,13,378,14,'dccv']
, [379,17,379,37,'dccv']
, [384,17,384,39,'dccv']
, [385,17,385,77,'dccv']
, [386,17,386,69,'dccv']
, [387,13,387,14,'dccv']
, [392,9,392,10,'dccv']
, [443,9,443,10,'dccv']
, [445,13,445,14,'dccv']
, [446,17,446,55,'dccv']
, [447,17,447,45,'dccv']
, [448,17,448,47,'dccv']
, [449,17,449,37,'dccv']
, [450,17,450,54,'dccv']
, [451,17,451,62,'dccv']
, [452,13,452,14,'dccv']
, [457,9,457,10,'dccv']
, [56,13,56,37,'dcuc']
, [57,13,57,14,'dcuc']
, [58,17,58,53,'dcuc']
, [59,13,59,14,'dcuc']
, [68,13,68,31,'dcuc']
, [69,13,69,14,'dcuc']
, [70,13,70,14,'dcuc']
, [78,17,78,18,'dcuc']
, [79,21,79,28,'dcuc']
, [93,13,93,37,'dcuc']
, [94,13,94,14,'dcuc']
, [95,17,95,53,'dcuc']
, [96,13,96,14,'dcuc']
, [105,13,105,37,'dcuc']
, [106,13,106,14,'dcuc']
, [107,17,107,53,'dcuc']
, [108,13,108,14,'dcuc']
, [113,9,113,10,'dcuc']
, [115,13,115,14,'dcuc']
, [116,17,116,90,'dcuc']
, [117,13,117,14,'dcuc']
, [118,13,118,37,'dcuc']
, [119,13,119,14,'dcuc']
, [120,17,120,53,'dcuc']
, [121,13,121,14,'dcuc']
, [122,9,122,10,'dcuc']
, [126,9,126,10,'dcuc']
, [128,13,128,14,'dcuc']
, [129,17,129,58,'dcuc']
, [130,17,130,52,'dcuc']
, [131,17,131,65,'dcuc']
, [132,13,132,14,'dcuc']
, [133,13,133,37,'dcuc']
, [134,13,134,14,'dcuc']
, [135,17,135,53,'dcuc']
, [136,13,136,14,'dcuc']
, [137,9,137,10,'dcuc']
, [141,9,141,10,'dcuc']
, [143,13,143,14,'dcuc']
, [144,17,144,68,'dcuc']
, [145,17,145,18,'dcuc']
, [146,21,146,73,'dcuc']
, [147,21,147,93,'dcuc']
, [148,21,148,69,'dcuc']
, [149,17,149,18,'dcuc']
, [150,13,150,14,'dcuc']
, [151,13,151,37,'dcuc']
, [152,13,152,14,'dcuc']
, [153,17,153,53,'dcuc']
, [154,13,154,14,'dcuc']
, [155,9,155,10,'dcuc']
, [183,17,183,18,'dcuc']
, [184,21,184,101,'dcuc']
, [185,21,185,83,'dcuc']
, [186,17,186,18,'dcuc']
, [188,13,188,37,'dcuc']
, [189,13,189,14,'dcuc']
, [190,17,190,53,'dcuc']
, [191,13,191,14,'dcuc']
, [212,13,212,37,'dcuc']
, [213,13,213,14,'dcuc']
, [214,17,214,53,'dcuc']
, [215,13,215,14,'dcuc']
, [226,13,226,37,'dcuc']
, [227,13,227,14,'dcuc']
, [228,17,228,53,'dcuc']
, [229,13,229,14,'dcuc']
, [241,13,241,37,'dcuc']
, [242,13,242,14,'dcuc']
, [243,17,243,53,'dcuc']
, [244,13,244,14,'dcuc']
, [254,13,254,37,'dcuc']
, [255,13,255,14,'dcuc']
, [256,17,256,53,'dcuc']
, [257,13,257,14,'dcuc']
, [272,13,272,37,'dcuc']
, [273,13,273,14,'dcuc']
, [274,17,274,53,'dcuc']
, [275,13,275,14,'dcuc']
, [284,13,284,37,'dcuc']
, [285,13,285,14,'dcuc']
, [286,17,286,53,'dcuc']
, [287,13,287,14,'dcuc']
, [304,13,304,37,'dcuc']
, [305,13,305,14,'dcuc']
, [306,17,306,53,'dcuc']
, [307,13,307,14,'dcuc']
, [348,13,348,31,'dcuc']
, [349,13,349,14,'dcuc']
, [350,13,350,14,'dcuc']
, [361,13,361,31,'dcuc']
, [362,13,362,14,'dcuc']
, [363,13,363,14,'dcuc']
, [380,17,380,18,'dcuc']
, [381,21,381,28,'dcuc']
, [388,13,388,37,'dcuc']
, [389,13,389,14,'dcuc']
, [390,17,390,53,'dcuc']
, [391,13,391,14,'dcuc']
, [399,9,399,10,'dcuc']
, [401,13,401,14,'dcuc']
, [402,13,402,14,'dcuc']
, [403,13,403,37,'dcuc']
, [404,13,404,14,'dcuc']
, [405,17,405,53,'dcuc']
, [406,13,406,14,'dcuc']
, [407,9,407,10,'dcuc']
, [414,9,414,10,'dcuc']
, [416,13,416,14,'dcuc']
, [417,13,417,14,'dcuc']
, [418,13,418,37,'dcuc']
, [419,13,419,14,'dcuc']
, [420,17,420,53,'dcuc']
, [421,13,421,14,'dcuc']
, [422,9,422,10,'dcuc']
, [428,9,428,10,'dcuc']
, [430,13,430,14,'dcuc']
, [431,13,431,14,'dcuc']
, [432,13,432,37,'dcuc']
, [433,13,433,14,'dcuc']
, [434,17,434,53,'dcuc']
, [435,13,435,14,'dcuc']
, [436,9,436,10,'dcuc']
, [453,13,453,37,'dcuc']
, [454,13,454,14,'dcuc']
, [455,17,455,53,'dcuc']
, [456,13,456,14,'dcuc']
];
		</script><link rel="stylesheet" type="text/css" href="../css/coverreport.css" />
	</head><body>
		<code id="src250" class="dotCoverSource"><pre>#region

using System;
using System.ComponentModel;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Input;
using System.Windows.Threading;
using LGP.Components.Factory;
using LGP.Components.Factory.Interfaces.Database;
using LGP.Components.Factory.Interfaces.Module;
using LGP.Modules.ModuleEditor.Internal;
using LGP.Modules.ModuleEditor.Internal.Modals.Controls;
using LGP.Modules.ModuleEditor.Internal.NodeViews;
using IModule = LGP.Components.Factory.Interfaces.Database.IModule;

#endregion

namespace LGP.Modules.ModuleEditor
{
    /// &lt;summary&gt;
    ///   Interaction logic for ModuleEditor.xaml
    /// &lt;/summary&gt;
    public partial class ModuleEditor : IUserControl , IModuleObserver
    {
        private readonly ModuleDocument _documentHandler;
        private readonly DispatcherTimer _editedCheckTimer;
        private IModule _module;

        /// &lt;summary&gt;
        ///   Constructor for the module
        /// &lt;/summary&gt;
        public ModuleEditor( IModule module )
        {
            try
            {
                this.InitializeComponent();
                this._module = module;
                this._module.Attach( this );
                this._documentHandler = new ModuleDocument( this._module , this , this.textEditor1 , this.textEditor2 );
                this.Prepare();

                this._editedCheckTimer = new DispatcherTimer
                {
                    Interval = TimeSpan.FromSeconds( 3 )
                };
                this._editedCheckTimer.Tick += this.IsEditedTick;
                this._editedCheckTimer.Start();

                this.ModuleViewBorderContainer.Child = new ModulePane( this._module , this._documentHandler );
                this.Tag = this._module.GetModuleName() + &quot;.pm&quot;;

                Framework.ShutDown += this.Terminate;
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void Terminate( object sender , CancelEventArgs args )
        {
            try
            {
                this.Dispose();
            }
            catch( Exception )
            {
            }
        }

        private void IsEditedTick( object sender , EventArgs e )
        {
            try
            {
                if( this._module == null )
                {
                    return;
                }

                if( this._documentHandler.GetHash() != this._module.GetHash() )
                {
                    this.SaveButton.IsEnabled = true;
                    this.SaveButton.Opacity = 1.0;
                }
                else
                {
                    this.SaveButton.IsEnabled = false;
                    this.SaveButton.Opacity = 0.3;
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void Prepare()
        {
            try
            {
                this.moduleNameLabel.Content = this._module.GetModuleName();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void MenuItemCopyClick( object sender , RoutedEventArgs e )
        {
            try
            {
                Clipboard.SetText( this.textEditor1.SelectedText , TextDataFormat.Text );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void MenuItemCutClick( object sender , RoutedEventArgs e )
        {
            try
            {
                var text = this.textEditor1.SelectedText;
                this.textEditor1.SelectedText = &quot;&quot;;
                Clipboard.SetText( text , TextDataFormat.Text );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void MenuItemPasteClick( object sender , RoutedEventArgs e )
        {
            try
            {
                if( Clipboard.ContainsText( TextDataFormat.Text ) )
                {
                    var text = Clipboard.GetText( TextDataFormat.Text );
                    this.textEditor1.Document.Insert( this.textEditor1.CaretOffset , text );
                    Clipboard.SetText( text , TextDataFormat.Text );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void GridViewSplitterChecked( object sender , RoutedEventArgs e )
        {
            try
            {
                var checkbox = sender as CheckBox;

                var editorGridWidth = this.editorGrid.ActualWidth;
                var editor1Column = this.editorGrid.ColumnDefinitions[ 0 ];
                var editor2Column = this.editorGrid.ColumnDefinitions[ 2 ];

                if( checkbox != null &amp;&amp; checkbox.IsChecked.HasValue )
                {
                    var checkedb = ( bool ) checkbox.GetValue( ToggleButton.IsCheckedProperty );
                    if( checkedb )
                    {
                        editor1Column.Width = new GridLength( ( editorGridWidth / 2 ) - 1 , GridUnitType.Star );
                        editor2Column.Width = new GridLength( ( editorGridWidth / 2 ) - 1 , GridUnitType.Star );
                    }
                    else
                    {
                        editor1Column.Width = new GridLength( editorGridWidth - 2 , GridUnitType.Star );
                        editor2Column.Width = new GridLength( 0 , GridUnitType.Star );
                    }
                }
                else
                {
                    editor1Column.Width = new GridLength( editorGridWidth - 2 , GridUnitType.Star );
                    editor2Column.Width = new GridLength( 0 , GridUnitType.Star );
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }


        private void UserControlLoaded( object sender , RoutedEventArgs e )
        {
            try
            {
                this.SplitViewImage.Source = Framework.Images.GetImage( &quot;LayoutSelectColumn&quot; , &quot;VS2010ImageLibrary&quot; , 16 ).Source;
                this.ImageCopy.Source = Framework.Images.GetImage( &quot;Copy&quot; , &quot;VS2010ImageLibrary&quot; ).Source;
                this.ImageCut.Source = Framework.Images.GetImage( &quot;Cut&quot; , &quot;VS2010ImageLibrary&quot; ).Source;
                this.ImageDelete.Source = Framework.Images.GetImage( &quot;Delete&quot; , &quot;VS2010ImageLibrary&quot; ).Source;
                this.ImagePaste.Source = Framework.Images.GetImage( &quot;Paste&quot; , &quot;VS2010ImageLibrary&quot; ).Source;
                this.ImageRedo.Source = Framework.Images.GetImage( &quot;Redo&quot; , &quot;VS2010ImageLibrary&quot; ).Source;
                this.ImageSave.Source = Framework.Images.GetImage( &quot;Save&quot; , &quot;VS2010ImageLibrary&quot; ).Source;
                this.ImageUndo.Source = Framework.Images.GetImage( &quot;Undo&quot; , &quot;VS2010ImageLibrary&quot; ).Source;
                this.ImageWrap.Source = Framework.Images.GetImage( &quot;WordWrap&quot; , &quot;VS2010ImageLibrary&quot; ).Source;
                this.ModuleImage.Source = Framework.Images.GetImage( &quot;lgp&quot; , &quot;128x128&quot; , 28 ).Source;
                this.DeleteMenuItem.Icon = Framework.Images.GetImage( &quot;DeleteHS&quot; , &quot;VS2010ImageLibrary&quot; , 12 );
                this.RenameMenuItem.Icon = Framework.Images.GetImage( &quot;RenameFolderHS&quot; , &quot;VS2010ImageLibrary&quot; , 12 );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void RenameMenuItemClick( object sender , RoutedEventArgs e )
        {
            try
            {
                this.ModuleLabelEditBox.Text = this.moduleNameLabel.Content.ToString();
                this.moduleNameLabel.Visibility = Visibility.Hidden;
                this.ModuleLabelEditBox.Visibility = Visibility.Visible;
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void DeleteMenuItemClick( object sender , RoutedEventArgs e )
        {
            try
            {
                var popup = Framework.Dialog;
                var cou = new DeleteModule( this , popup , this._module );
                popup.SetChild( cou );
                popup.ShowBlocking();
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void ModuleLabelEditBoxTextChanged( object sender , TextChangedEventArgs e )
        {
            try
            {
                this.ModuleLabelEditBox.Text = Framework.Utils.CleanString( this.ModuleLabelEditBox.Text );
                this.ModuleLabelEditBox.CaretIndex = this.ModuleLabelEditBox.Text.Length;
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void ModuleEditBoxKeyUp( object sender , KeyEventArgs e )
        {
            try
            {
                if( e.Key == Key.Return &amp;&amp; this.ModuleLabelEditBox.Text.Length &gt; 0 )
                {
                    this.ModuleLabelEditBox.Visibility = Visibility.Hidden;
                    this.moduleNameLabel.Visibility = Visibility.Visible;
                    this._module.SetModuleName( this.ModuleLabelEditBox.Text );
                    this.moduleNameLabel.Content = this._module.GetModuleName();
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void SaveMenuItemClick( object sender , RoutedEventArgs e )
        {
            try
            {
                this._module.FileContents = this._documentHandler.Document.Text;
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        private void ToolBarLoaded( object sender , RoutedEventArgs e )
        {
            try
            {
                var toolBar = sender as ToolBar;
                if( toolBar != null )
                {
                    var overflowGrid = toolBar.Template.FindName( &quot;OverflowGrid&quot; , toolBar ) as FrameworkElement;
                    if( overflowGrid != null )
                    {
                        overflowGrid.Visibility = Visibility.Collapsed;
                    }
                }
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        #region Implementation of IUserControl

        /// &lt;summary&gt;
        ///   Asks the UserControl to do some clean up!
        /// &lt;/summary&gt;
        public void Dispose()
        {
            try
            {
                this._documentHandler.Dispose( this );
                this._module.Detach( this );
                this._editedCheckTimer.Stop();
                this._module = null;

                var pane = ( ModulePane ) this.ModuleViewBorderContainer.Child;
                pane.Dispose( this );
            }
            catch( Exception )
            {
            }
        }

        /// &lt;summary&gt;
        /// Asks the Usercontrol to refresh itself
        /// &lt;/summary&gt;
        public void Refresh()
        {
            this.Tag = this._module.GetModuleName() + &quot;.pm&quot;;
        }

        /// &lt;summary&gt;
        /// When the control is no longer in focus, asks it to pause ( heavy duty non critical, ie threads updating graphs )
        /// &lt;/summary&gt;
        public void Pause()
        {
            try
            {
            }
            catch( Exception )
            {
            }
        }

        /// &lt;summary&gt;
        /// When the tab comes back into focus, resume ( heavy duty non critical, ie threads updating graphs )
        /// &lt;/summary&gt;
        public void Resume()
        {
            try
            {
            }
            catch( Exception )
            {
            }
        }

        #endregion

        #region Implementation of IModuleObserver

        /// &lt;summary&gt;
        ///   Update this observer with a refernece to the module
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;module&quot;&gt;IModule&lt;/param&gt;
        /// &lt;param name = &quot;source&quot;&gt;IModuleObserver&lt;/param&gt;
        public void Update( IModule module , IModuleObserver source )
        {
            try
            {
                if( source == this )
                {
                    return;
                }

                this._module = module;
                this.moduleNameLabel.Content = this._module.GetModuleName();
                this.Tag = this._module.GetModuleName() + &quot; Module&quot;;
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Attach objewcts that observer this module
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IModuleObserver&lt;/param&gt;
        public void Attach( IModuleObserver obj )
        {
            try
            {
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Detach objewcts that observer this module
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IModuleObserver&lt;/param&gt;
        public void Detach( IModuleObserver obj )
        {
            try
            {
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Notify observers of this module
        /// &lt;/summary&gt;
        public void Notify()
        {
            try
            {
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        /// &lt;summary&gt;
        ///   Dispose this object and all the observers
        /// &lt;/summary&gt;
        /// &lt;param name = &quot;obj&quot;&gt;IModuleObserver&lt;/param&gt;
        public void Dispose( IModuleObserver obj )
        {
            try
            {
                this._documentHandler.Dispose( this );
                this._module.Detach( this );
                this._editedCheckTimer.Stop();
                this._module = null;
                Framework.ShutDown -= this.Terminate;
                Framework.Panels.RemoveMainComponent( this );
            }
            catch( Exception error )
            {
                Framework.EventBus.Publish( error );
            }
        }

        #endregion
    }
}</pre></code><script type="text/javascript">
			applyranges('src250', RANGES_250)
		</script>
	</body>
</html>